<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;">
    <title>Daisy's Tracker</title>
    <script type="text/javascript" src="cordova.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background-color: #000000;
            color: #4bff21;
            line-height: 1.6;
            padding: 10px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #0a0a0a;
            border: 2px solid #4bff21;
            border-radius: 10px;
            overflow: hidden;
        }

        .header {
            text-align: center;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            padding: 20px;
            border-bottom: 2px solid #4bff21;
        }

        .header h1 {
            font-size: 2em;
            color: #f8e602;
            text-shadow: 0 0 10px #f8e602;
            margin-bottom: 5px;
        }

        .header p {
            color: #4bff21;
            font-size: 0.9em;
        }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            flex-wrap: wrap;
            background-color: #1a1a1a;
            border-bottom: 2px solid #4bff21;
            overflow-x: auto;
        }

        .tab-button {
            flex: 1;
            min-width: 150px;
            padding: 15px 10px;
            background-color: #0a0a0a;
            color: #4bff21;
            border: none;
            border-right: 1px solid #333;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9em;
            transition: all 0.3s ease;
            text-align: center;
        }

        .tab-button:hover {
            background-color: #1a1a1a;
            color: #f8e602;
        }

        .tab-button.active {
            background-color: #4bff21;
            color: #000000;
            font-weight: bold;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Form Styling */
        .form-section {
            background-color: #1a1a1a;
            border: 2px solid #4bff21;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .section-title {
            color: #f8e602;
            font-size: 1.2em;
            margin-bottom: 15px;
            border-bottom: 1px solid #f8e602;
            padding-bottom: 5px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 10px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #00f0ff;
            font-size: 0.9em;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 8px;
            background-color: #000;
            border: 1px solid #4bff21;
            color: #4bff21;
            border-radius: 3px;
            font-family: inherit;
            font-size: 0.9em;
        }

        /* Checkbox Groups */
        .checkbox-section {
            background-color: #0a0a0a;
            border: 1px solid #772289;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .checkbox-section h4 {
            color: #f4d5fd;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 5px;
            transition: all 0.2s ease;
        }

        .checkbox-item:hover {
            background-color: rgba(119, 34, 137, 0.1);
        }

        input[type="checkbox"] {
            min-width: 18px;
            min-height: 18px;
            margin-right: 8px;
            cursor: pointer;
            accent-color: #00f0ff;
        }

        .checkbox-item label {
            color: #ccc;
            cursor: pointer;
            font-size: 0.9em;
        }

        /* Investigation Notes */
        .notes-section {
            background-color: #1a1a1a;
            border: 2px solid #772289;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .notes-section h3 {
            color: #f4d5fd;
            margin-bottom: 10px;
        }

        .notes-section textarea {
            width: 100%;
            min-height: 100px;
            background-color: #0a0a0a;
            border: 1px solid #772289;
            color: #f4d5fd;
            padding: 10px;
            border-radius: 3px;
            font-family: inherit;
        }

        /* Buttons */
        .button-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            padding: 15px;
            background-color: #1a1a1a;
            border-radius: 5px;
            position: sticky;
            bottom: 0;
            z-index: 100;
        }

        .btn {
            padding: 12px 20px;
            background-color: #003300;
            color: #4bff21;
            border: 2px solid #4bff21;
            border-radius: 5px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9em;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .btn:hover {
            background-color: #4bff21;
            color: #000;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(75, 255, 33, 0.3);
        }

        .btn-primary {
            background-color: #772289;
            border-color: #f4d5fd;
            color: #f4d5fd;
        }

        .btn-primary:hover {
            background-color: #f4d5fd;
            color: #772289;
        }

        .btn-warning {
            background-color: #664400;
            border-color: #f8e602;
            color: #f8e602;
        }

        .btn-warning:hover {
            background-color: #f8e602;
            color: #000;
        }

        /* Results Display */
        .results {
            background-color: #0a0a0a;
            border: 2px solid #00f0ff;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            max-height: 500px;
            overflow-y: auto;
            display: none;
        }

        .results.active {
            display: block;
        }

        .results h3 {
            color: #00f0ff;
            margin-bottom: 15px;
        }

        .query-item {
            background-color: #1a1a1a;
            border-left: 4px solid #4bff21;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 3px;
        }

        .query-category {
            color: #f8e602;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .query-text {
            color: #4bff21;
            word-break: break-all;
            font-size: 0.85em;
            line-height: 1.4;
        }

        /* File Manager */
        .file-manager {
            background-color: #1a1a1a;
            border: 2px solid #f8e602;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .file-list {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
        }

        .file-item {
            background-color: #0a0a0a;
            border: 1px solid #333;
            padding: 10px;
            margin-bottom: 5px;
            border-radius: 3px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-name {
            color: #4bff21;
            flex: 1;
        }

        .file-actions {
            display: flex;
            gap: 5px;
        }

        .file-btn {
            padding: 5px 10px;
            font-size: 0.75em;
            background-color: #003300;
            color: #4bff21;
            border: 1px solid #4bff21;
            border-radius: 3px;
            cursor: pointer;
        }

        .file-btn:hover {
            background-color: #4bff21;
            color: #000;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .tab-button {
                min-width: 100px;
                padding: 10px 5px;
                font-size: 0.8em;
            }

            .checkbox-grid {
                grid-template-columns: 1fr;
            }

            .button-row {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0a0a0a;
        }

        ::-webkit-scrollbar-thumb {
            background: #4bff21;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #00f0ff;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåº Daisy Tracker</h1>
            <p>Dork, Build, Track Digital Footprints</p>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-button active" onclick="showTab('import-export')">üìÅ Files & Subjects</button>
            <button class="tab-button" onclick="showTab('user-input')">üìù User Input</button>
            <button class="tab-button" onclick="showTab('checkboxes')">‚òëÔ∏è Checkboxes</button>
        </div>

        <!-- TAB 1: IMPORT/EXPORT -->
        <div id="import-export" class="tab-content active">
            <div class="file-manager">
                <h3 style="color: #f8e602; margin-bottom: 15px;">üìÅ File Management</h3>

                <!-- Storage Location Selector -->
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="color: #4bff21; font-weight: bold;">üíæ Save Location:</label>
                    <select id="storage-location" style="width: 100%; padding: 10px; background-color: #1a1a1a; border: 2px solid #4bff21; color: #4bff21; border-radius: 3px;">
                        <option value="downloads">üì• Downloads Folder</option>
                        <option value="documents">üìÑ Documents Folder</option>
                        <option value="daisystracker">üåº Daisy's Tracker Folder (App Storage)</option>
                        <option value="custom">üìÇ Choose Custom Location</option>
                    </select>
                    <p style="color: #888; font-size: 0.85em; margin-top: 5px;">Select where to save your files and folders</p>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Folder Name:</label>
                        <input type="text" id="folder-name" placeholder="e.g., Problem Residence, Active Cases">
                    </div>
                    <div class="form-group" style="display: flex; align-items: flex-end; gap: 10px;">
                        <button class="btn" onclick="createFolderOnDevice()">‚ûï Create Folder</button>
                        <button class="btn" onclick="loadFiles()">üîÑ Refresh</button>
                    </div>
                </div>
                <div class="file-list" id="file-list">
                    <p style="color: #888;">No saved subject files yet. Use "Save inputs as file" in the User Input tab to create files.</p>
                </div>
            </div>

            <div class="results" id="results-display">
                <h3>üîç Generated Queries</h3>
                <div class="button-row" style="margin-bottom: 15px;">
                    <button class="btn btn-primary" onclick="copyAllQueries()">üìã Copy All Queries</button>
                </div>
                <p style="color: #888; font-size: 0.9em; margin-top: 10px;">
                    üí° Queries are displayed here for you to copy and use. To save your inputs as a file for later, use the "Save inputs as file" button in the User Input tab.
                </p>
                <div id="query-results"></div>
            </div>

            <!-- SUBJECTS MANAGEMENT SECTION -->
            <div style="padding: 20px; background-color: #1a1a1a; border: 2px solid #4bff21; border-radius: 5px; margin-top: 30px;">
                <h2 style="color: #4bff21; margin-bottom: 15px;">üë§ Subjects Management</h2>
                <p style="color: #888; font-size: 1em; margin-bottom: 15px;">
                    View, search, and manage your saved subjects. Add photos, track gang affiliations, criminal history, and social media accounts.
                </p>
                <p style="color: #f8e602; font-size: 1em; margin-bottom: 15px;">
                    ‚û°Ô∏è To <strong>add a new subject</strong>, go to the <strong>"User Input"</strong> tab, fill out the investigation fields, then scroll down to the "Subject Profile Tracking" section to add category, gang info, priors, social accounts, and photos. Then click "Save as Subject Profile".
                </p>
                <div style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="showTab('user-input')" style="font-size: 1em; padding: 12px 20px;">üìù Go to User Input (Add Subject)</button>
                    <button class="btn btn-success" onclick="viewSubjectsList()" style="margin-left: 10px; font-size: 1em; padding: 12px 20px;">üë• View All Subjects</button>
                </div>

                <!-- Import Subject -->
                <div style="padding: 15px; background-color: #0a0a0a; border: 2px solid #00f0ff; border-radius: 5px;">
                    <h3 style="color: #00f0ff; margin-bottom: 10px;">üì• Import Subject from Markdown</h3>
                    <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">Import a previously exported subject markdown file (.md)</p>
                    <input type="file" id="subject-import-input" accept=".md,.txt" style="display: none;" onchange="importSubjectFromMarkdown(event)">
                    <button class="btn btn-primary" onclick="document.getElementById('subject-import-input').click()">üìÇ Select Markdown File to Import</button>
                </div>

                <!-- Subjects List Section -->
                <div id="subjects-list" style="margin-top: 20px; padding: 20px; background-color: #0a0a0a; border: 2px solid #4bff21; border-radius: 5px; display: none;">
                    <h3 style="color: #f8e602; margin-bottom: 15px;">üë• Saved Subjects</h3>

                    <!-- Search Box -->
                    <div style="margin-bottom: 15px;">
                        <input type="text" id="subjects-search" placeholder="üîç Search subjects by name, gang, category..." onkeyup="searchSubjects()" style="width: 100%; padding: 10px; background-color: #1a1a1a; border: 2px solid #00f0ff; color: #4bff21; border-radius: 3px;">
                    </div>

                    <!-- Filter by Category -->
                    <div style="margin-bottom: 15px;">
                        <label style="color: #f8e602;">Filter by Category:</label>
                        <select id="subjects-category-filter" onchange="filterSubjectsByCategory()" style="width: 100%; padding: 10px; background-color: #1a1a1a; border: 1px solid #4bff21; color: #4bff21; border-radius: 3px;">
                            <option value="">All Categories</option>
                        </select>
                    </div>

                    <div id="subjects-list-container">
                        <!-- Subjects will be listed here -->
                    </div>

                    <button class="btn" onclick="hideSubjectsList()" style="margin-top: 15px;">Close List</button>
                </div>
            </div>

            <div class="button-row" style="margin-top: 20px;">
                <button class="btn btn-primary" onclick="showTab('user-input')">Next: User Input ‚Üí</button>
            </div>
        </div>

        <!-- TAB 2: USER INPUT -->
        <div id="user-input" class="tab-content">
            <div class="notes-section">
                <h3>üìù Investigation Notes (Private - Not Used in Queries)</h3>
                <input type="text" id="case-name" placeholder="Case/Subject Name" style="margin-bottom: 10px; background-color: #0a0a0a; border: 1px solid #772289; color: #f4d5fd; padding: 10px; border-radius: 3px; width: 100%;">
                <textarea id="investigation-notes" placeholder="Enter private investigation notes, observations, timeline, evidence tracking...&#10;&#10;These notes will NOT be used in search queries - they are for your documentation only."></textarea>
            </div>

            <div class="form-section">
                <div class="section-title">üë§ Person Information</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>First Name:</label>
                        <input type="text" id="first-name" placeholder="First name">
                    </div>
                    <div class="form-group">
                        <label>Last Name:</label>
                        <input type="text" id="last-name" placeholder="Last name">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Middle Name/Initial:</label>
                        <input type="text" id="middle-name" placeholder="Middle name">
                    </div>
                    <div class="form-group">
                        <label>Aliases/Nicknames:</label>
                        <input type="text" id="aliases" placeholder="Nicknames/aliases (comma separated for multiple)">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Date of Birth:</label>
                        <input type="text" id="dob" placeholder="MM/DD/YYYY">
                    </div>
                    <div class="form-group">
                        <label>Age/Age Range:</label>
                        <input type="text" id="age" placeholder="e.g., 25 or 25-30">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">üìç Contact & Location</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Email Address:</label>
                        <input type="email" id="email" placeholder="Email address">
                    </div>
                    <div class="form-group">
                        <label>Phone Number:</label>
                        <input type="tel" id="phone" placeholder="Phone number">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Username/Handle:</label>
                        <input type="text" id="username" placeholder="Username (comma separated for multiple)">
                    </div>
                    <div class="form-group">
                        <label>Account ID:</label>
                        <input type="text" id="account-id" placeholder="Numeric ID or identifier">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Street Address:</label>
                        <input type="text" id="address" placeholder="Street address">
                    </div>
                    <div class="form-group" style="opacity: 0; pointer-events: none;">
                        <!-- Spacer for alignment -->
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>City:</label>
                        <input type="text" id="city" placeholder="City">
                    </div>
                    <div class="form-group">
                        <label>State/Province:</label>
                        <input type="text" id="state" placeholder="State">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Country:</label>
                        <input type="text" id="country" placeholder="Country">
                    </div>
                    <div class="form-group">
                        <label>ZIP/Postal Code:</label>
                        <input type="text" id="zip" placeholder="ZIP code">
                    </div>
                </div>
            </div>

            <div class="form-section" style="background-color: #0a0a1a; border: 1px solid #00f0ff;">
                <div class="section-title" style="color: #00f0ff;">üì± Social Media Accounts</div>
                <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">
                    Add known social media accounts for this investigation. Use "Add Another" to track multiple platforms.
                    <br><strong style="color: #f8e602;">üìù Note:</strong> These fields are for <strong>reference/notes only</strong>. To generate OSINT queries, use the platform checkboxes in the <strong>‚òëÔ∏è Checkboxes tab</strong>.
                </p>

                <div id="investigation-social-accounts-container">
                    <div class="social-account-entry" id="inv-social-entry-1">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Platform:</label>
                                <input type="text" class="inv-social-platform" placeholder="Facebook, Instagram, Twitter..." data-entry="1">
                            </div>
                            <div class="form-group">
                                <label>Username/Handle:</label>
                                <input type="text" class="inv-social-username" placeholder="@username" data-entry="1">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Account ID:</label>
                                <input type="text" class="inv-social-account-id" placeholder="Numeric ID or unique identifier" data-entry="1">
                            </div>
                            <div class="form-group">
                                <label>Profile URL:</label>
                                <input type="text" class="inv-social-url" placeholder="https://..." data-entry="1">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Display Name:</label>
                                <input type="text" class="inv-social-display-name" placeholder="Name shown on profile" data-entry="1">
                            </div>
                        </div>
                    </div>
                </div>
                <button class="btn" onclick="addInvestigationSocialAccount()" style="margin-top: 8px; background-color: #00f0ff; color: #000; font-size: 0.9em;">‚ûï Add Another Social Account</button>
            </div>

            <div class="form-section">
                <div class="section-title">üíº Professional & Education</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Occupation/Job Title:</label>
                        <input type="text" id="occupation" placeholder="Job title">
                    </div>
                    <div class="form-group">
                        <label>Employer/Company:</label>
                        <input type="text" id="employer" placeholder="Company name">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>School/University:</label>
                        <input type="text" id="school" placeholder="Educational institution">
                    </div>
                    <div class="form-group">
                        <label>Interests/Hobbies:</label>
                        <input type="text" id="interests" placeholder="Interests (comma separated)">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">üè† Property (Residence/Business)</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Property Address:</label>
                        <input type="text" id="property-address" placeholder="Street address of property">
                    </div>
                    <div class="form-group">
                        <label>Property Type:</label>
                        <input type="text" id="property-type" placeholder="e.g., Residence, Business, Apartment">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Property Owner:</label>
                        <input type="text" id="property-owner" placeholder="Owner name">
                    </div>
                    <div class="form-group">
                        <label>Business Name (if applicable):</label>
                        <input type="text" id="business-name" placeholder="Business name at location">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">üöó Vehicles</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Vehicle VIN:</label>
                        <input type="text" id="vehicle-vin" placeholder="Vehicle Identification Number">
                    </div>
                    <div class="form-group">
                        <label>License Plate:</label>
                        <input type="text" id="license-plate" placeholder="License plate number">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Vehicle Make:</label>
                        <input type="text" id="vehicle-make" placeholder="e.g., Toyota, Ford, Honda">
                    </div>
                    <div class="form-group">
                        <label>Vehicle Model:</label>
                        <input type="text" id="vehicle-model" placeholder="e.g., Camry, F-150, Civic">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Vehicle Year:</label>
                        <input type="text" id="vehicle-year" placeholder="Vehicle year">
                    </div>
                    <div class="form-group">
                        <label>Vehicle Color:</label>
                        <input type="text" id="vehicle-color" placeholder="Vehicle color">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">üì¶ Misc Property</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Serial Number:</label>
                        <input type="text" id="serial-number" placeholder="Serial number">
                    </div>
                    <div class="form-group">
                        <label>Make:</label>
                        <input type="text" id="misc-make" placeholder="e.g., Apple, Sony, Samsung">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Model:</label>
                        <input type="text" id="misc-model" placeholder="e.g., MacBook Pro, PlayStation 5">
                    </div>
                    <div class="form-group">
                        <label>Description:</label>
                        <input type="text" id="property-description" placeholder="e.g., Electronics, Jewelry, Tools">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">üï≥Ô∏è Dark Web Investigation</div>
                <div class="form-group">
                    <label>Target Name/Alias:</label>
                    <input type="text" id="dw-target" placeholder="Dark web target or alias">
                </div>
                <div class="form-group">
                    <label>Keywords:</label>
                    <input type="text" id="dw-keywords" placeholder="Search keywords (comma separated)">
                </div>
                <div class="form-group">
                    <label>Bitcoin/Crypto Address:</label>
                    <input type="text" id="dw-bitcoin" placeholder="Bitcoin or cryptocurrency address">
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">üîç Additional Information</div>
                <div class="form-group">
                    <label>Known Associates:</label>
                    <input type="text" id="associates" placeholder="Names of associates, friends, family (comma separated)">
                </div>
                <div class="form-group">
                    <label>IP Address (for technical investigation):</label>
                    <input type="text" id="ip-address" placeholder="IP address">
                </div>
                <div class="form-group">
                    <label>Domain/Website:</label>
                    <input type="text" id="domain" placeholder="Domain or website URL">
                </div>
                <div class="form-group">
                    <label>Keywords for Search:</label>
                    <input type="text" id="keywords" placeholder="Additional keywords (comma separated)">
                </div>
            </div>

            <!-- SAVE INPUTS AS FILE SECTION -->
            <div class="form-section" style="border: 3px solid #f8e602; background-color: #1a1a0a; margin-top: 20px;" id="save-inputs-section">
                <div class="section-title" style="color: #f8e602;">üíæ Save Inputs as File</div>
                <p style="color: #888; font-size: 0.9em; margin-bottom: 10px;">
                    <strong style="color: #4bff21;">Want to save your inputs for later?</strong><br>
                    Click the button below to add subject details (category, gang info, priors, MO, photos) and save as a Subject Profile (MD file) that you can load, export, and share.
                </p>

                <button class="btn" onclick="showSaveInputsForm()" id="save-inputs-btn" style="background-color: #f8e602; color: #000; font-size: 1em; padding: 12px 20px; margin-bottom: 15px;">
                    üíæ Save inputs as file
                </button>

                <div id="subject-profile-fields" style="display: none;">
                <p style="color: #f8e602; font-size: 0.95em; margin-bottom: 15px;">
                    ‚úèÔ∏è <strong>Fill out the fields below to create your Subject Profile file:</strong>
                </p>
                <div class="form-group">
                    <label style="font-weight: bold; color: #f8e602;">Subject Category:</label>
                    <input type="text" id="subject-category" placeholder="Gang Related, Suspect, Person of Interest, etc." style="background-color: #1a1a1a; border: 2px solid #f8e602;">
                </div>

                <div class="form-group">
                    <label style="color: #ff9999;">Gang Affiliation:</label>
                    <textarea id="subject-gang" placeholder="Gang name, set, territory, associates..." rows="2" style="background-color: #1a1a1a; border: 1px solid #ff0000; color: #ff9999;"></textarea>
                </div>

                <div class="form-group">
                    <label style="color: #ffcc99;">Priors / Criminal History:</label>
                    <textarea id="subject-priors" placeholder="Arrests, convictions, charges, case numbers..." rows="3" style="background-color: #1a1a1a; border: 1px solid #ff6600; color: #ffcc99;"></textarea>
                </div>

                <div class="form-group">
                    <label>MO (Modus Operandi):</label>
                    <textarea id="subject-mo" placeholder="Known patterns, behaviors..." rows="2"></textarea>
                </div>

                <div style="margin: 15px 0; padding: 12px; background-color: #0a0a0a; border: 1px solid #00f0ff; border-radius: 5px;">
                    <h4 style="color: #00f0ff; margin-bottom: 8px; font-size: 1em;">üì± Social Media Accounts</h4>
                    <div id="social-accounts-container">
                        <div class="social-account-entry" id="social-entry-1">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Platform:</label>
                                    <input type="text" class="social-platform" placeholder="Facebook, Instagram..." data-entry="1">
                                </div>
                                <div class="form-group">
                                    <label>Username:</label>
                                    <input type="text" class="social-username" placeholder="@username" data-entry="1">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>URL/ID:</label>
                                    <input type="text" class="social-account-id" placeholder="Profile URL" data-entry="1">
                                </div>
                                <div class="form-group">
                                    <label>Display Name:</label>
                                    <input type="text" class="social-display-name" placeholder="Profile name" data-entry="1">
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="btn" onclick="addSocialAccount()" style="margin-top: 8px; background-color: #00f0ff; color: #000; font-size: 0.9em;">‚ûï Add Another</button>
                </div>

                <div style="margin: 15px 0; padding: 12px; background-color: #0a0a0a; border: 1px solid #4bff21; border-radius: 5px;">
                    <h4 style="color: #4bff21; margin-bottom: 8px; font-size: 1em;">üì∏ Photo Attachments</h4>
                    <input type="file" id="subject-photo-input" accept="image/jpeg,image/jpg,image/png" multiple style="display: none;" onchange="handlePhotoSelection(event)">
                    <button class="btn btn-primary" onclick="document.getElementById('subject-photo-input').click()" style="font-size: 0.9em;">üìÅ Select Photos</button>
                    <p style="color: #888; font-size: 0.8em; margin-top: 5px;">Mugshots, surveillance, screenshots</p>
                    <div id="subject-photos-preview" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 8px; margin-top: 10px;"></div>
                </div>

                <div style="margin-top: 15px;">
                    <button class="btn btn-success" onclick="saveSubject()" style="font-size: 1em; padding: 12px 20px;">üíæ Save as Subject Profile (MD File)</button>
                    <button class="btn" onclick="clearSubjectFields()" style="margin-left: 8px;">üóëÔ∏è Clear Subject Fields</button>
                </div>
                </div><!-- end subject-profile-fields -->
            </div>

            <div class="button-row">
                <button class="btn" onclick="showTab('import-export')">‚Üê Back: Import/Export</button>
                <button class="btn btn-primary" onclick="showTab('checkboxes')">Next: Checkboxes ‚Üí</button>
                <button class="btn btn-warning" onclick="generateQueries()">üîç Generate Queries</button>
            </div>
        </div>

        <!-- TAB 3: CHECKBOXES (ALL CHECKBOXES) -->
        <div id="checkboxes" class="tab-content">
            <div class="checkbox-section">
                <h4>üîç Base Person Searches</h4>
                <div class="checkbox-grid">
                    <div class="checkbox-item">
                        <input type="checkbox" id="base-general" checked>
                        <label for="base-general">General Person Search</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="base-records" checked>
                        <label for="base-records">Official Records & Documents</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="base-news" checked>
                        <label for="base-news">News & Media Coverage</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="base-government" checked>
                        <label for="base-government">Government & Public Records</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="catch-all">
                        <label for="catch-all">All People Search Sites (TruePeopleSearch, IDCrawl, WebMii, etc.)</label>
                    </div>
                </div>
            </div>

            <div class="checkbox-section">
                <h4>üåê Social Media Platforms - Select Individual Platforms</h4>
                <p style="color: #888; font-size: 0.85em; margin-bottom: 10px;">Check only the platforms your target uses. Each platform auto-generates: Profile, Posts, Comments, Photos, Followers, etc.</p>

                <div style="margin-bottom: 15px;">
                    <button class="btn" style="padding: 8px 15px; font-size: 0.85em;" onclick="checkAllSocial(true)">‚úì Check All</button>
                    <button class="btn" style="padding: 8px 15px; font-size: 0.85em;" onclick="checkAllSocial(false)">‚úó Uncheck All</button>
                </div>

                <!-- Collapsible: Major Social Media -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">üì± Major Social Media (5 platforms) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-facebook" class="social-platform">
                        <label for="platform-facebook">Facebook</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-instagram" class="social-platform">
                        <label for="platform-instagram">Instagram</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-twitter" class="social-platform">
                        <label for="platform-twitter">Twitter / X</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-tiktok" class="social-platform">
                        <label for="platform-tiktok">TikTok</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-snapchat" class="social-platform">
                        <label for="platform-snapchat">Snapchat</label>
                    </div>
                    </div>
                </details>

                <!-- Collapsible: Professional Networks -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">üíº Professional Networks (3 platforms) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-linkedin" class="social-platform">
                        <label for="platform-linkedin">LinkedIn</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-indeed" class="social-platform">
                        <label for="platform-indeed">Indeed</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-glassdoor" class="social-platform">
                        <label for="platform-glassdoor">Glassdoor</label>
                    </div>
                    </div>
                </details>

                <!-- Collapsible: Video Platforms -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">üìπ Video Platforms (4 platforms) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-youtube" class="social-platform">
                        <label for="platform-youtube">YouTube</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-twitch" class="social-platform">
                        <label for="platform-twitch">Twitch</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-vimeo" class="social-platform">
                        <label for="platform-vimeo">Vimeo</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-rumble" class="social-platform">
                        <label for="platform-rumble">Rumble</label>
                    </div>
                    </div>
                </details>

                <!-- Collapsible: Gaming & Communities -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">üéÆ Gaming & Communities (7 platforms) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-discord" class="social-platform">
                        <label for="platform-discord">Discord</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-steam" class="social-platform">
                        <label for="platform-steam">Steam</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-xbox" class="social-platform">
                        <label for="platform-xbox">Xbox Live</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-playstation" class="social-platform">
                        <label for="platform-playstation">PlayStation Network</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-reddit" class="social-platform">
                        <label for="platform-reddit">Reddit</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-4chan" class="social-platform">
                        <label for="platform-4chan">4chan</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-quora" class="social-platform">
                        <label for="platform-quora">Quora</label>
                    </div>
                    </div>
                </details>

                <!-- Collapsible: Messaging Apps -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">üí¨ Messaging Apps (4 platforms) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-telegram" class="social-platform">
                        <label for="platform-telegram">Telegram</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-whatsapp" class="social-platform">
                        <label for="platform-whatsapp">WhatsApp</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-signal" class="social-platform">
                        <label for="platform-signal">Signal</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-viber" class="social-platform">
                        <label for="platform-viber">Viber</label>
                    </div>
                    </div>
                </details>

                <!-- Collapsible: Dating Platforms -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">‚ù§Ô∏è Dating Platforms (5 platforms) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-tinder" class="social-platform">
                        <label for="platform-tinder">Tinder</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-bumble" class="social-platform">
                        <label for="platform-bumble">Bumble</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-match" class="social-platform">
                        <label for="platform-match">Match.com</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-hinge" class="social-platform">
                        <label for="platform-hinge">Hinge</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-okcupid" class="social-platform">
                        <label for="platform-okcupid">OKCupid</label>
                    </div>
                    </div>
                </details>

                <!-- Collapsible: Creative & Portfolio -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">üé® Creative & Portfolio (4 platforms) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-pinterest" class="social-platform">
                        <label for="platform-pinterest">Pinterest</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-deviantart" class="social-platform">
                        <label for="platform-deviantart">DeviantArt</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-behance" class="social-platform">
                        <label for="platform-behance">Behance</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-dribbble" class="social-platform">
                        <label for="platform-dribbble">Dribbble</label>
                    </div>
                    </div>
                </details>

                <!-- Collapsible: International Platforms -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">üåè International Platforms (5 platforms) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-vk" class="social-platform">
                        <label for="platform-vk">VK (Russia)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-wechat" class="social-platform">
                        <label for="platform-wechat">WeChat (China)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-qq" class="social-platform">
                        <label for="platform-qq">QQ (China)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-weibo" class="social-platform">
                        <label for="platform-weibo">Weibo (China)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-line" class="social-platform">
                        <label for="platform-line">LINE (Japan)</label>
                    </div>
                    </div>
                </details>

                <!-- Collapsible: Alternative/Free Speech Platforms -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">üó£Ô∏è Alternative/Free Speech Platforms (4 platforms) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-parler" class="social-platform">
                        <label for="platform-parler">Parler</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-gab" class="social-platform">
                        <label for="platform-gab">Gab</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-truthsocial" class="social-platform">
                        <label for="platform-truthsocial">Truth Social</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="platform-gettr" class="social-platform">
                        <label for="platform-gettr">Gettr</label>
                    </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <h4>üîó Sock Puppet Detection & Account Linking</h4>
                <p style="color: #888; font-size: 0.85em; margin-bottom: 10px;">Automatically cross-reference data across platforms to find connected accounts</p>
                <div class="checkbox-grid">
                    <div class="checkbox-item">
                        <input type="checkbox" id="sock-puppet-username" checked>
                        <label for="sock-puppet-username">Username Cross-Reference (find same username on other platforms)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="sock-puppet-email" checked>
                        <label for="sock-puppet-email">Email Cross-Reference (find accounts using same email)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="sock-puppet-phone" checked>
                        <label for="sock-puppet-phone">Phone Cross-Reference (find accounts using same phone)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="sock-puppet-name">
                        <label for="sock-puppet-name">Name Variations (find accounts with similar names)</label>
                    </div>
                </div>
            </div>

            <div class="checkbox-section">
                <h4>üåç International Domain Searches - Select Individual Countries</h4>
                <p style="color: #888; font-size: 0.85em; margin-bottom: 10px;">Check only the countries relevant to your investigation (e.g., if target is in UK, check only UK)</p>

                <!-- Collapsible: Americas -->
                <details style="margin-bottom: 10px; border: 1px solid #00f0ff; border-radius: 5px; padding: 10px; background: rgba(0, 240, 255, 0.05);">
                    <summary style="color: #00f0ff; cursor: pointer; font-weight: bold; padding: 5px;">üåé Americas (10 countries) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item"><input type="checkbox" id="domain-us" class="domain-checkbox"><label for="domain-us">üá∫üá∏ United States (.us)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ca" class="domain-checkbox"><label for="domain-ca">üá®üá¶ Canada (.ca)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-br" class="domain-checkbox"><label for="domain-br">üáßüá∑ Brazil (.br)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-mx" class="domain-checkbox"><label for="domain-mx">üá≤üáΩ Mexico (.mx)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ar" class="domain-checkbox"><label for="domain-ar">üá¶üá∑ Argentina (.ar)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-cl" class="domain-checkbox"><label for="domain-cl">üá®üá± Chile (.cl)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-co" class="domain-checkbox"><label for="domain-co">üá®üá¥ Colombia (.co)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-pe" class="domain-checkbox"><label for="domain-pe">üáµüá™ Peru (.pe)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ve" class="domain-checkbox"><label for="domain-ve">üáªüá™ Venezuela (.ve)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-pr" class="domain-checkbox"><label for="domain-pr">üáµüá∑ Puerto Rico (.pr)</label></div>
                    </div>
                </details>

                <!-- Collapsible: Europe -->
                <details style="margin-bottom: 10px; border: 1px solid #00f0ff; border-radius: 5px; padding: 10px; background: rgba(0, 240, 255, 0.05);">
                    <summary style="color: #00f0ff; cursor: pointer; font-weight: bold; padding: 5px;">üá™üá∫ Europe (25 countries) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item"><input type="checkbox" id="domain-uk" class="domain-checkbox"><label for="domain-uk">üá¨üáß United Kingdom (.uk)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-de" class="domain-checkbox"><label for="domain-de">üá©üá™ Germany (.de)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-fr" class="domain-checkbox"><label for="domain-fr">üá´üá∑ France (.fr)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-it" class="domain-checkbox"><label for="domain-it">üáÆüáπ Italy (.it)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-es" class="domain-checkbox"><label for="domain-es">üá™üá∏ Spain (.es)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-nl" class="domain-checkbox"><label for="domain-nl">üá≥üá± Netherlands (.nl)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-se" class="domain-checkbox"><label for="domain-se">üá∏üá™ Sweden (.se)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-no" class="domain-checkbox"><label for="domain-no">üá≥üá¥ Norway (.no)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-dk" class="domain-checkbox"><label for="domain-dk">üá©üá∞ Denmark (.dk)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-fi" class="domain-checkbox"><label for="domain-fi">üá´üáÆ Finland (.fi)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-pl" class="domain-checkbox"><label for="domain-pl">üáµüá± Poland (.pl)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-cz" class="domain-checkbox"><label for="domain-cz">üá®üáø Czech Republic (.cz)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-at" class="domain-checkbox"><label for="domain-at">üá¶üáπ Austria (.at)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ch" class="domain-checkbox"><label for="domain-ch">üá®üá≠ Switzerland (.ch)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-be" class="domain-checkbox"><label for="domain-be">üáßüá™ Belgium (.be)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-pt" class="domain-checkbox"><label for="domain-pt">üáµüáπ Portugal (.pt)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-gr" class="domain-checkbox"><label for="domain-gr">üá¨üá∑ Greece (.gr)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ie" class="domain-checkbox"><label for="domain-ie">üáÆüá™ Ireland (.ie)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ru" class="domain-checkbox"><label for="domain-ru">üá∑üá∫ Russia (.ru)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ua" class="domain-checkbox"><label for="domain-ua">üá∫üá¶ Ukraine (.ua)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ro" class="domain-checkbox"><label for="domain-ro">üá∑üá¥ Romania (.ro)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-hu" class="domain-checkbox"><label for="domain-hu">üá≠üá∫ Hungary (.hu)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-bg" class="domain-checkbox"><label for="domain-bg">üáßüá¨ Bulgaria (.bg)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-tr" class="domain-checkbox"><label for="domain-tr">üáπüá∑ Turkey (.tr)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-is" class="domain-checkbox"><label for="domain-is">üáÆüá∏ Iceland (.is)</label></div>
                    </div>
                </details>

                <!-- Collapsible: Asia & Pacific -->
                <details style="margin-bottom: 10px; border: 1px solid #00f0ff; border-radius: 5px; padding: 10px; background: rgba(0, 240, 255, 0.05);">
                    <summary style="color: #00f0ff; cursor: pointer; font-weight: bold; padding: 5px;">üåè Asia & Pacific (20 countries) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item"><input type="checkbox" id="domain-cn" class="domain-checkbox"><label for="domain-cn">üá®üá≥ China (.cn)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-jp" class="domain-checkbox"><label for="domain-jp">üáØüáµ Japan (.jp)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-kr" class="domain-checkbox"><label for="domain-kr">üá∞üá∑ South Korea (.kr)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-in" class="domain-checkbox"><label for="domain-in">üáÆüá≥ India (.in)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-au" class="domain-checkbox"><label for="domain-au">üá¶üá∫ Australia (.au)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-nz" class="domain-checkbox"><label for="domain-nz">üá≥üáø New Zealand (.nz)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-sg" class="domain-checkbox"><label for="domain-sg">üá∏üá¨ Singapore (.sg)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-th" class="domain-checkbox"><label for="domain-th">üáπüá≠ Thailand (.th)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-my" class="domain-checkbox"><label for="domain-my">üá≤üáæ Malaysia (.my)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-id" class="domain-checkbox"><label for="domain-id">üáÆüá© Indonesia (.id)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ph" class="domain-checkbox"><label for="domain-ph">üáµüá≠ Philippines (.ph)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-vn" class="domain-checkbox"><label for="domain-vn">üáªüá≥ Vietnam (.vn)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-tw" class="domain-checkbox"><label for="domain-tw">üáπüáº Taiwan (.tw)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-hk" class="domain-checkbox"><label for="domain-hk">üá≠üá∞ Hong Kong (.hk)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-pk" class="domain-checkbox"><label for="domain-pk">üáµüá∞ Pakistan (.pk)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-bd" class="domain-checkbox"><label for="domain-bd">üáßüá© Bangladesh (.bd)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-lk" class="domain-checkbox"><label for="domain-lk">üá±üá∞ Sri Lanka (.lk)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-np" class="domain-checkbox"><label for="domain-np">üá≥üáµ Nepal (.np)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-kh" class="domain-checkbox"><label for="domain-kh">üá∞üá≠ Cambodia (.kh)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-mm" class="domain-checkbox"><label for="domain-mm">üá≤üá≤ Myanmar (.mm)</label></div>
                    </div>
                </details>

                <!-- Collapsible: Middle East -->
                <details style="margin-bottom: 10px; border: 1px solid #00f0ff; border-radius: 5px; padding: 10px; background: rgba(0, 240, 255, 0.05);">
                    <summary style="color: #00f0ff; cursor: pointer; font-weight: bold; padding: 5px;">üåç Middle East (12 countries) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item"><input type="checkbox" id="domain-ae" class="domain-checkbox"><label for="domain-ae">üá¶üá™ UAE (.ae)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-sa" class="domain-checkbox"><label for="domain-sa">üá∏üá¶ Saudi Arabia (.sa)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-il" class="domain-checkbox"><label for="domain-il">üáÆüá± Israel (.il)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ir" class="domain-checkbox"><label for="domain-ir">üáÆüá∑ Iran (.ir)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-iq" class="domain-checkbox"><label for="domain-iq">üáÆüá∂ Iraq (.iq)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-jo" class="domain-checkbox"><label for="domain-jo">üáØüá¥ Jordan (.jo)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-lb" class="domain-checkbox"><label for="domain-lb">üá±üáß Lebanon (.lb)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-kw" class="domain-checkbox"><label for="domain-kw">üá∞üáº Kuwait (.kw)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-qa" class="domain-checkbox"><label for="domain-qa">üá∂üá¶ Qatar (.qa)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-bh" class="domain-checkbox"><label for="domain-bh">üáßüá≠ Bahrain (.bh)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-om" class="domain-checkbox"><label for="domain-om">üá¥üá≤ Oman (.om)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ye" class="domain-checkbox"><label for="domain-ye">üáæüá™ Yemen (.ye)</label></div>
                    </div>
                </details>

                <!-- Collapsible: Africa -->
                <details style="margin-bottom: 10px; border: 1px solid #00f0ff; border-radius: 5px; padding: 10px; background: rgba(0, 240, 255, 0.05);">
                    <summary style="color: #00f0ff; cursor: pointer; font-weight: bold; padding: 5px;">üåç Africa (10 countries) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item"><input type="checkbox" id="domain-za" class="domain-checkbox"><label for="domain-za">üáøüá¶ South Africa (.za)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ng" class="domain-checkbox"><label for="domain-ng">üá≥üá¨ Nigeria (.ng)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-eg" class="domain-checkbox"><label for="domain-eg">üá™üá¨ Egypt (.eg)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ke" class="domain-checkbox"><label for="domain-ke">üá∞üá™ Kenya (.ke)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-gh" class="domain-checkbox"><label for="domain-gh">üá¨üá≠ Ghana (.gh)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-tz" class="domain-checkbox"><label for="domain-tz">üáπüáø Tanzania (.tz)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ug" class="domain-checkbox"><label for="domain-ug">üá∫üá¨ Uganda (.ug)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-ma" class="domain-checkbox"><label for="domain-ma">üá≤üá¶ Morocco (.ma)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-dz" class="domain-checkbox"><label for="domain-dz">üá©üáø Algeria (.dz)</label></div>
                        <div class="checkbox-item"><input type="checkbox" id="domain-tn" class="domain-checkbox"><label for="domain-tn">üáπüá≥ Tunisia (.tn)</label></div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Person Categories - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #f4d5fd; border-radius: 5px; padding: 10px; background: rgba(244, 213, 253, 0.05);">
                    <summary style="color: #f4d5fd; cursor: pointer; font-weight: bold; padding: 5px;">üéØ Person Categories - Specialized Searches (9 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="person-politician">
                            <label for="person-politician">üèõÔ∏è Politician/Public Official</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="person-law-enforcement">
                            <label for="person-law-enforcement">üëÆ Law Enforcement Officer</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="person-military">
                            <label for="person-military">ü™ñ Military Personnel</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="person-judge">
                            <label for="person-judge">‚öñÔ∏è Judge/Legal Professional</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="person-doctor">
                            <label for="person-doctor">ü©∫ Medical Professional</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="person-ceo">
                            <label for="person-ceo">üíº CEO/Business Executive</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="person-professor">
                            <label for="person-professor">üéì Professor/Academic</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="person-journalist">
                            <label for="person-journalist">üì∞ Journalist/Reporter</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="person-celebrity">
                            <label for="person-celebrity">‚≠ê Celebrity/Influencer</label>
                        </div>
                    </div>
                </details>
            </div>

            <p style="color: #f8e602; font-size: 0.9em; margin: 15px 0; padding: 10px; background: rgba(248, 230, 2, 0.1); border-left: 3px solid #f8e602;">
                üìÑ <strong>Document Searches:</strong> Document queries (PDF, Word, Excel, etc.) are automatically generated using the name, username, and email you entered in the User Input tab. No need to check document boxes!
            </p>

            <div class="checkbox-section">
                <!-- Exposed & Vulnerable Files - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">üîì Exposed & Vulnerable Files (7 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="exposed-all">
                            <label for="exposed-all">‚ö†Ô∏è ALL Exposed Files (Databases, Configs, Logs, Backups, Git)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="exposed-databases">
                            <label for="exposed-databases">üóÑÔ∏è Exposed Databases (SQL, MongoDB, ElasticSearch, Redis)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="exposed-configs">
                            <label for="exposed-configs">‚öôÔ∏è Configuration Files (.env, config, settings, yml)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="exposed-logs">
                            <label for="exposed-logs">üìù Log Files (Error logs, Access logs, Debug logs)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="exposed-backups">
                            <label for="exposed-backups">üíæ Backup Files (.bak, .old, .backup, dump files)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="exposed-git">
                            <label for="exposed-git">üìÇ Git Repositories (.git, exposed repos, credentials)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="exposed-directories">
                            <label for="exposed-directories">üìÅ Open Directories (Directory listing enabled)</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Sensitive Information - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #772289; border-radius: 5px; padding: 10px; background: rgba(119, 34, 137, 0.05);">
                    <summary style="color: #772289; cursor: pointer; font-weight: bold; padding: 5px;">üîí Sensitive Information (5 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="sensitive-all">
                            <label for="sensitive-all">üö® ALL Sensitive Data (SSN, Credit Cards, Passwords, API Keys, etc.)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sensitive-credentials">
                            <label for="sensitive-credentials">üîë Passwords & Credentials (Login, API keys, Tokens)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sensitive-pii">
                            <label for="sensitive-pii">üë§ Personal Identifiable Info (SSN, ID numbers, Passports)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sensitive-financial">
                            <label for="sensitive-financial">üí≥ Financial Data (Credit cards, Bank accounts, Payment info)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sensitive-medical">
                            <label for="sensitive-medical">üè• Medical Records (Health info, Patient data)</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Dark Web Investigation - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #00f0ff; border-radius: 5px; padding: 10px; background: rgba(0, 240, 255, 0.05);">
                    <summary style="color: #00f0ff; cursor: pointer; font-weight: bold; padding: 5px;">üï≥Ô∏è Dark Web Investigation (5 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="darkweb-all">
                            <label for="darkweb-all">üåê ALL Dark Web Searches (All .onion domains + Tor engines)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="darkweb-marketplaces">
                            <label for="darkweb-marketplaces">üõí Dark Web Marketplaces (All major markets)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="darkweb-forums">
                            <label for="darkweb-forums">üí¨ Dark Web Forums (Hacking, Crime, Trade forums)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="darkweb-crypto">
                            <label for="darkweb-crypto">‚Çø Cryptocurrency Tracking (Bitcoin, Monero, Wallets)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="darkweb-engines">
                            <label for="darkweb-engines">üîç Tor Search Engines (Ahmia, Torch, NotEvil, etc.)</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Criminal Records - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #4bff21; border-radius: 5px; padding: 10px; background: rgba(75, 255, 33, 0.05);">
                    <summary style="color: #4bff21; cursor: pointer; font-weight: bold; padding: 5px;">üöî Criminal Records (6 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="criminal-all-records">
                            <label for="criminal-all-records">üìã ALL Criminal Records (Arrest, Mugshots, Court, Warrants, Sentencing)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="criminal-arrests">
                            <label for="criminal-arrests">üö® Arrest Records</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="criminal-mugshots">
                            <label for="criminal-mugshots">üì∏ Mugshots</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="criminal-court">
                            <label for="criminal-court">‚öñÔ∏è Court Records</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="criminal-warrants">
                            <label for="criminal-warrants">üìú Active Warrants</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="criminal-sex-offender">
                            <label for="criminal-sex-offender">‚ö†Ô∏è Sex Offender Registry</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Criminal Activity Categories - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">üî´ Criminal Activity Categories (7 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="crime-organized">
                            <label for="crime-organized">üé≠ Organized Crime (Gangs, Cartels, Mafia, Syndicates)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="crime-drugs">
                            <label for="crime-drugs">üíä Drug Activity (Narcotics, Distribution, Manufacturing)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="crime-trafficking">
                            <label for="crime-trafficking">üö´ Human/Weapons Trafficking</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="crime-terrorism">
                            <label for="crime-terrorism">üí£ Terrorism & Extremism (All groups and patterns)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="crime-cyber">
                            <label for="crime-cyber">üíª Cybercrime (Hacking, Fraud, Identity Theft)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="crime-financial">
                            <label for="crime-financial">üí∞ Financial Crimes (Money Laundering, Fraud, Embezzlement)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="crime-violent">
                            <label for="crime-violent">üî™ Violent Crimes (Assault, Murder, Robbery)</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Criminal Investigation - International - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #772289; border-radius: 5px; padding: 10px; background: rgba(119, 34, 137, 0.05);">
                    <summary style="color: #772289; cursor: pointer; font-weight: bold; padding: 5px;">üåç Criminal Investigation - International (2 options) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="crime-domains-all">
                            <label for="crime-domains-all">üåê ALL International Criminal Databases (100+ countries)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="crime-interpol">
                            <label for="crime-interpol">üö® INTERPOL & International Agencies</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Property & Asset Investigation - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #00f0ff; border-radius: 5px; padding: 10px; background: rgba(0, 240, 255, 0.05);">
                    <summary style="color: #00f0ff; cursor: pointer; font-weight: bold; padding: 5px;">üè† Property & Asset Investigation (5 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="property-real-estate">
                            <label for="property-real-estate">üè° Real Estate Records (Ownership, Sales, Tax records)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="property-vehicles">
                            <label for="property-vehicles">üöó Vehicle Records (Registration, VIN, Title)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="property-business">
                            <label for="property-business">üè¢ Business Ownership (LLC, Corporation, Partnership)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="property-boats">
                            <label for="property-boats">‚õµ Boats & Marine Vessels</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="property-aircraft">
                            <label for="property-aircraft">‚úàÔ∏è Aircraft Registration</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Stolen Property Investigation - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #f4d5fd; border-radius: 5px; padding: 10px; background: rgba(244, 213, 253, 0.05);">
                    <summary style="color: #f4d5fd; cursor: pointer; font-weight: bold; padding: 5px;">üîç Stolen Property Investigation (3 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="stolen-all-marketplaces">
                            <label for="stolen-all-marketplaces">üõí ALL Marketplaces (eBay, Craigslist, Facebook, OfferUp, etc.)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="stolen-auctions">
                            <label for="stolen-auctions">üî® Auction Sites (Government, Liquidation, Pawn shops)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="stolen-specialized">
                            <label for="stolen-specialized">üéØ Specialized Sites (Auto, Electronics, Collectibles, etc.)</label>
                        </div>
                    </div>
                </details>
            </div>
            <div class="checkbox-section">
                <!-- IP & Domain Investigation - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #4bff21; border-radius: 5px; padding: 10px; background: rgba(75, 255, 33, 0.05);">
                    <summary style="color: #4bff21; cursor: pointer; font-weight: bold; padding: 5px;">üåê IP & Domain Investigation (4 options) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="tech-ip-all">
                            <label for="tech-ip-all">üîç Complete IP Investigation (WHOIS, Geolocation, Reverse DNS)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="tech-domain-all">
                            <label for="tech-domain-all">üåê Domain Investigation (WHOIS, History, Subdomains)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="tech-ssl">
                            <label for="tech-ssl">üîí SSL/TLS Certificate Investigation</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="tech-dns">
                            <label for="tech-dns">üì° DNS Records (A, MX, TXT, NS records)</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Web Technologies & Frameworks - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #f8e602; border-radius: 5px; padding: 10px; background: rgba(248, 230, 2, 0.05);">
                    <summary style="color: #f8e602; cursor: pointer; font-weight: bold; padding: 5px;">‚öôÔ∏è Web Technologies & Frameworks (4 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="tech-cms-all">
                            <label for="tech-cms-all">üìù ALL CMS Systems (WordPress, Joomla, Drupal, etc.)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="tech-servers">
                            <label for="tech-servers">üñ•Ô∏è Web Servers (Apache, Nginx, IIS, LiteSpeed)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="tech-frameworks">
                            <label for="tech-frameworks">üîß Frameworks (React, Angular, Vue, Laravel, Django)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="tech-languages">
                            <label for="tech-languages">üíª Languages & Platforms (PHP, Python, Node.js, Java)</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Security & Vulnerabilities - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #772289; border-radius: 5px; padding: 10px; background: rgba(119, 34, 137, 0.05);">
                    <summary style="color: #772289; cursor: pointer; font-weight: bold; padding: 5px;">üîê Security & Vulnerabilities (5 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="vuln-all">
                            <label for="vuln-all">‚ö†Ô∏è ALL Vulnerability Scans (SQL, XSS, Directory, Admin panels)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="vuln-sql">
                            <label for="vuln-sql">üíâ SQL Injection Vulnerabilities</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="vuln-xss">
                            <label for="vuln-xss">‚ö° XSS (Cross-Site Scripting)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="vuln-admin">
                            <label for="vuln-admin">üîì Admin Panels & Login Pages</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="vuln-ports">
                            <label for="vuln-ports">üîå Open Ports & Services</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Network & Infrastructure - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #00f0ff; border-radius: 5px; padding: 10px; background: rgba(0, 240, 255, 0.05);">
                    <summary style="color: #00f0ff; cursor: pointer; font-weight: bold; padding: 5px;">üì° Network & Infrastructure (3 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="network-analysis">
                            <label for="network-analysis">üåê Network Analysis (ASN, BGP, Routing)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="network-cdn">
                            <label for="network-cdn">‚òÅÔ∏è CDN & Cloud Services (Cloudflare, AWS, Azure)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="network-iot">
                            <label for="network-iot">üì± IoT Devices (Cameras, Routers, Smart devices)</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="checkbox-section">
                <!-- Pre-Built Dork Templates - Collapsible -->
                <details style="margin-bottom: 10px; border: 1px solid #f4d5fd; border-radius: 5px; padding: 10px; background: rgba(244, 213, 253, 0.05);">
                    <summary style="color: #f4d5fd; cursor: pointer; font-weight: bold; padding: 5px;">üõ†Ô∏è Pre-Built Dork Templates (4 categories) - Click to expand</summary>
                    <div class="checkbox-grid" style="margin-top: 10px;">
                        <div class="checkbox-item">
                            <input type="checkbox" id="templates-credentials">
                            <label for="templates-credentials">üîë Credential Exposure Templates</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="templates-configs">
                            <label for="templates-configs">‚öôÔ∏è Configuration File Templates</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="templates-databases">
                            <label for="templates-databases">üóÑÔ∏è Database Exposure Templates</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="templates-api">
                            <label for="templates-api">üîå API Endpoint Discovery</label>
                        </div>
                    </div>
                </details>
            </div>

            <div class="button-row">
                <button class="btn" onclick="showTab('user-input')">‚Üê Back: User Input</button>
                <button class="btn btn-primary" onclick="showTab('subjects')">Next: Subjects ‚Üí</button>
                <button class="btn btn-warning" onclick="generateQueries()">üîç Generate Queries</button>
            </div>
        </div>

        <!-- TAB 4: SUBJECTS (Person Tracking) -->
        <!-- TAB 4: SUBJECTS (List & Management) -->
        <div id="subjects" class="tab-content">
            <div style="padding: 20px; background-color: #1a1a1a; border: 2px solid #f8e602; border-radius: 5px; margin-bottom: 20px;">
                <h2 style="color: #f8e602; margin-bottom: 15px;">üë§ Subjects Management</h2>
                <p style="color: #888; font-size: 1em; margin-bottom: 15px;">
                    This tab is for viewing, searching, and managing your saved subjects.
                </p>
                <p style="color: #4bff21; font-size: 1em; margin-bottom: 15px;">
                    ‚û°Ô∏è To <strong>add a new subject</strong>, go to the <strong>"User Input"</strong> tab (Tab 2), fill out the investigation fields, then scroll down to the "Subject Profile Tracking" section to add category, gang info, priors, social accounts, and photos. Then click "Save as Subject Profile".
                </p>
                <div>
                    <button class="btn btn-primary" onclick="showTab('user-input')" style="font-size: 1em; padding: 12px 20px;">üìù Go to User Input (Add Subject)</button>
                    <button class="btn btn-success" onclick="viewSubjectsList()" style="margin-left: 10px; font-size: 1em; padding: 12px 20px;">üë• View All Subjects</button>
                </div>
            </div>

            <!-- Import Subject -->
            <div style="padding: 20px; background-color: #0a0a0a; border: 2px solid #00f0ff; border-radius: 5px;">
                <h3 style="color: #00f0ff; margin-bottom: 10px;">üì• Import Subject from Markdown</h3>
                <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">Import a previously exported subject markdown file (.md)</p>
                <input type="file" id="subject-import-input" accept=".md,.txt" style="display: none;" onchange="importSubjectFromMarkdown(event)">
                <button class="btn btn-primary" onclick="document.getElementById('subject-import-input').click()">üìÇ Select Markdown File to Import</button>
            </div>

            <!-- Subjects List Section -->
            <div id="subjects-list" style="margin-top: 30px; padding: 20px; background-color: #0a0a0a; border: 2px solid #4bff21; border-radius: 5px; display: none;">
                <h3 style="color: #f8e602; margin-bottom: 15px;">üë• Saved Subjects</h3>

                <!-- Search Box -->
                <div style="margin-bottom: 15px;">
                    <input type="text" id="subjects-search" placeholder="üîç Search subjects by name, gang, category..." onkeyup="searchSubjects()" style="width: 100%; padding: 10px; background-color: #1a1a1a; border: 2px solid #00f0ff; color: #4bff21; border-radius: 3px;">
                </div>

                <!-- Filter by Category -->
                <div style="margin-bottom: 15px;">
                    <label style="color: #f8e602;">Filter by Category:</label>
                    <select id="subjects-category-filter" onchange="filterSubjectsByCategory()" style="width: 100%; padding: 10px; background-color: #1a1a1a; border: 1px solid #4bff21; color: #4bff21; border-radius: 3px;">
                        <option value="">All Categories</option>
                    </select>
                </div>

                <div id="subjects-list-container">
                    <!-- Subjects will be listed here -->
                </div>

                <button class="btn" onclick="hideSubjectsList()" style="margin-top: 15px;">Close List</button>
            </div>
        </div>
    </div>

    <script>
        // Tab Management
        function showTab(tabId) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Remove active from all buttons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Show selected tab
            document.getElementById(tabId).classList.add('active');

            // Highlight active button
            const tabNames = ['data-input', 'person-social', 'docs-darkweb', 'criminal-property', 'technical', 'results'];
            const index = tabNames.indexOf(tabId);
            if (index !== -1) {
                buttons[index].classList.add('active');
            }

            // Scroll to top
            window.scrollTo(0, 0);
        }

        // Helper: Check/Uncheck All Social Platforms
        function checkAllSocial(checked) {
            const checkboxes = document.querySelectorAll('.social-platform');
            checkboxes.forEach(cb => cb.checked = checked);
        }

        // Platform Database - Complete configuration for each platform
        const PLATFORMS = {
            'facebook': {
                name: 'Facebook',
                site: 'facebook.com',
                icon: 'üìò',
                queries: ['profile', 'posts', 'comments', 'photos', 'friends', 'groups', 'pages', 'location']
            },
            'instagram': {
                name: 'Instagram',
                site: 'instagram.com',
                icon: 'üì∑',
                queries: ['profile', 'posts', 'comments', 'tagged', 'followers', 'following', 'stories', 'reels', 'location']
            },
            'twitter': {
                name: 'Twitter/X',
                site: 'twitter.com',
                icon: 'üê¶',
                queries: ['profile', 'tweets', 'replies', 'media', 'likes', 'followers', 'following', 'lists', 'location']
            },
            'tiktok': {
                name: 'TikTok',
                site: 'tiktok.com',
                icon: 'üéµ',
                queries: ['profile', 'videos', 'comments', 'likes', 'followers', 'following', 'hashtags', 'location']
            },
            'snapchat': {
                name: 'Snapchat',
                site: 'snapchat.com',
                icon: 'üëª',
                queries: ['profile', 'stories', 'snap map', 'friends']
            },
            'linkedin': {
                name: 'LinkedIn',
                site: 'linkedin.com',
                icon: 'üíº',
                queries: ['profile', 'posts', 'activity', 'connections', 'employment', 'recommendations', 'groups']
            },
            'indeed': {
                name: 'Indeed',
                site: 'indeed.com',
                icon: 'üíº',
                queries: ['profile', 'resumes', 'reviews']
            },
            'glassdoor': {
                name: 'Glassdoor',
                site: 'glassdoor.com',
                icon: 'üíº',
                queries: ['profile', 'reviews', 'salaries']
            },
            'youtube': {
                name: 'YouTube',
                site: 'youtube.com',
                icon: 'üìπ',
                queries: ['channel', 'videos', 'comments', 'playlists', 'subscribers', 'community']
            },
            'twitch': {
                name: 'Twitch',
                site: 'twitch.tv',
                icon: 'üéÆ',
                queries: ['channel', 'streams', 'clips', 'videos', 'followers', 'following']
            },
            'vimeo': {
                name: 'Vimeo',
                site: 'vimeo.com',
                icon: 'üìπ',
                queries: ['profile', 'videos', 'likes', 'followers']
            },
            'rumble': {
                name: 'Rumble',
                site: 'rumble.com',
                icon: 'üìπ',
                queries: ['channel', 'videos', 'followers']
            },
            'discord': {
                name: 'Discord',
                site: 'discord.com',
                icon: 'üí¨',
                queries: ['profile', 'servers', 'messages', 'friends']
            },
            'steam': {
                name: 'Steam',
                site: 'steamcommunity.com',
                icon: 'üéÆ',
                queries: ['profile', 'games', 'friends', 'groups', 'screenshots', 'reviews']
            },
            'xbox': {
                name: 'Xbox Live',
                site: 'xbox.com',
                icon: 'üéÆ',
                queries: ['profile', 'gamertag', 'achievements', 'friends']
            },
            'playstation': {
                name: 'PlayStation',
                site: 'playstation.com',
                icon: 'üéÆ',
                queries: ['profile', 'trophies', 'friends']
            },
            'reddit': {
                name: 'Reddit',
                site: 'reddit.com',
                icon: 'ü§ñ',
                queries: ['user', 'posts', 'comments', 'subreddits', 'karma']
            },
            '4chan': {
                name: '4chan',
                site: '4chan.org',
                icon: 'üí≠',
                queries: ['posts', 'threads']
            },
            'quora': {
                name: 'Quora',
                site: 'quora.com',
                icon: '‚ùì',
                queries: ['profile', 'answers', 'questions', 'followers']
            },
            'telegram': {
                name: 'Telegram',
                site: 'telegram.org',
                icon: '‚úàÔ∏è',
                queries: ['profile', 'channels', 'groups', 'messages']
            },
            'whatsapp': {
                name: 'WhatsApp',
                site: 'web.whatsapp.com',
                icon: 'üí¨',
                queries: ['profile', 'groups']
            },
            'signal': {
                name: 'Signal',
                site: 'signal.org',
                icon: 'üîí',
                queries: ['profile', 'groups']
            },
            'viber': {
                name: 'Viber',
                site: 'viber.com',
                icon: 'üí¨',
                queries: ['profile', 'communities']
            },
            'tinder': {
                name: 'Tinder',
                site: 'tinder.com',
                icon: '‚ù§Ô∏è',
                queries: ['profile', 'matches']
            },
            'bumble': {
                name: 'Bumble',
                site: 'bumble.com',
                icon: 'üêù',
                queries: ['profile', 'matches']
            },
            'match': {
                name: 'Match.com',
                site: 'match.com',
                icon: '‚ù§Ô∏è',
                queries: ['profile', 'matches']
            },
            'hinge': {
                name: 'Hinge',
                site: 'hinge.co',
                icon: '‚ù§Ô∏è',
                queries: ['profile', 'matches']
            },
            'okcupid': {
                name: 'OKCupid',
                site: 'okcupid.com',
                icon: '‚ù§Ô∏è',
                queries: ['profile', 'matches', 'questions']
            },
            'pinterest': {
                name: 'Pinterest',
                site: 'pinterest.com',
                icon: 'üìå',
                queries: ['profile', 'pins', 'boards', 'followers']
            },
            'deviantart': {
                name: 'DeviantArt',
                site: 'deviantart.com',
                icon: 'üé®',
                queries: ['profile', 'gallery', 'favorites', 'watchers']
            },
            'behance': {
                name: 'Behance',
                site: 'behance.net',
                icon: 'üé®',
                queries: ['profile', 'projects', 'followers']
            },
            'dribbble': {
                name: 'Dribbble',
                site: 'dribbble.com',
                icon: 'üé®',
                queries: ['profile', 'shots', 'followers']
            },
            'vk': {
                name: 'VK',
                site: 'vk.com',
                icon: 'üá∑üá∫',
                queries: ['profile', 'posts', 'photos', 'friends', 'groups']
            },
            'wechat': {
                name: 'WeChat',
                site: 'wechat.com',
                icon: 'üá®üá≥',
                queries: ['profile', 'moments', 'contacts']
            },
            'qq': {
                name: 'QQ',
                site: 'qq.com',
                icon: 'üá®üá≥',
                queries: ['profile', 'qzone', 'friends']
            },
            'weibo': {
                name: 'Weibo',
                site: 'weibo.com',
                icon: 'üá®üá≥',
                queries: ['profile', 'posts', 'followers', 'following']
            },
            'line': {
                name: 'LINE',
                site: 'line.me',
                icon: 'üáØüáµ',
                queries: ['profile', 'timeline', 'friends']
            },
            'parler': {
                name: 'Parler',
                site: 'parler.com',
                icon: 'üó£Ô∏è',
                queries: ['profile', 'posts', 'followers']
            },
            'gab': {
                name: 'Gab',
                site: 'gab.com',
                icon: 'üó£Ô∏è',
                queries: ['profile', 'gabs', 'followers']
            },
            'truthsocial': {
                name: 'Truth Social',
                site: 'truthsocial.com',
                icon: 'üó£Ô∏è',
                queries: ['profile', 'truths', 'followers']
            },
            'gettr': {
                name: 'Gettr',
                site: 'gettr.com',
                icon: 'üó£Ô∏è',
                queries: ['profile', 'posts', 'followers']
            }
        };

        // Generate platform-specific queries automatically
        function generatePlatformQueries(platformKey, data) {
            const platform = PLATFORMS[platformKey];
            if (!platform) return [];

            const queries = [];
            const searchTarget = data.username || data.fullName;
            if (!searchTarget) return [];

            const icon = platform.icon;
            const queryTypes = platform.queries;

            // Generate specific queries based on platform capabilities
            queryTypes.forEach(type => {
                let query = '';
                let category = `${icon} ${platform.name} - ${type.charAt(0).toUpperCase() + type.slice(1)}`;

                switch(type) {
                    case 'profile':
                        query = `site:${platform.site} "${searchTarget}"`;
                        break;
                    case 'posts':
                    case 'tweets':
                    case 'gabs':
                    case 'truths':
                    case 'videos':
                    case 'pins':
                        query = `site:${platform.site} "${searchTarget}" (post OR status OR update OR published OR uploaded)`;
                        break;
                    case 'comments':
                    case 'replies':
                        query = `site:${platform.site} "${searchTarget}" (comment OR reply OR responded)`;
                        break;
                    case 'photos':
                    case 'media':
                    case 'gallery':
                    case 'shots':
                        query = `site:${platform.site} "${searchTarget}" (photo OR image OR picture OR media)`;
                        break;
                    case 'followers':
                    case 'following':
                    case 'friends':
                    case 'connections':
                    case 'watchers':
                    case 'subscribers':
                        query = `site:${platform.site} "${searchTarget}" (follower OR following OR friend OR connection OR subscriber)`;
                        break;
                    case 'groups':
                    case 'communities':
                    case 'servers':
                    case 'channels':
                    case 'subreddits':
                        query = `site:${platform.site} "${searchTarget}" (group OR community OR server OR channel)`;
                        break;
                    case 'location':
                        if (data.personLocation) {
                            query = `site:${platform.site} "${searchTarget}" "${data.personLocation}"`;
                        }
                        break;
                    case 'employment':
                        if (data.employer) {
                            query = `site:${platform.site} "${searchTarget}" "${data.employer}"`;
                        }
                        break;
                    case 'tagged':
                        query = `site:${platform.site} "tagged" "${searchTarget}"`;
                        break;
                    default:
                        query = `site:${platform.site} "${searchTarget}" ${type}`;
                }

                if (query) {
                    queries.push({ category, query });
                }
            });

            return queries;
        }

        // Sock Puppet Detection - Cross-reference queries
        function generateSockPuppetQueries(data) {
            const queries = [];

            // Username cross-reference
            if (document.getElementById('sock-puppet-username').checked && data.username) {
                const majorSites = ['facebook.com', 'instagram.com', 'twitter.com', 'linkedin.com', 'reddit.com',
                                   'youtube.com', 'tiktok.com', 'github.com', 'medium.com', 'pinterest.com'];

                queries.push({
                    category: 'üîó Username Cross-Reference - All Platforms',
                    query: `"${data.username}" (site:${majorSites.join(' OR site:')})`
                });

                queries.push({
                    category: 'üîó Username Variations',
                    query: `("${data.username}" OR "${data.username}123" OR "${data.username}_" OR "_${data.username}")`
                });
            }

            // Email cross-reference
            if (document.getElementById('sock-puppet-email').checked && data.email) {
                queries.push({
                    category: 'üîó Email Cross-Reference',
                    query: `"${data.email}" (account OR profile OR registered OR user)`
                });

                queries.push({
                    category: 'üîó Email on Social Platforms',
                    query: `"${data.email}" (site:facebook.com OR site:linkedin.com OR site:twitter.com OR site:instagram.com)`
                });
            }

            // Phone cross-reference
            if (document.getElementById('sock-puppet-phone').checked && data.phone) {
                queries.push({
                    category: 'üîó Phone Number Cross-Reference',
                    query: `"${data.phone}" (account OR profile OR contact OR registered)`
                });

                queries.push({
                    category: 'üîó Phone on Social Platforms',
                    query: `"${data.phone}" (site:facebook.com OR site:linkedin.com OR site:twitter.com OR site:telegram.org OR site:whatsapp.com)`
                });
            }

            // Name variations
            if (document.getElementById('sock-puppet-name').checked && data.fullName) {
                const nameParts = data.fullName.split(' ');
                if (nameParts.length >= 2) {
                    const firstName = nameParts[0];
                    const lastName = nameParts[nameParts.length - 1];

                    queries.push({
                        category: 'üîó Name Variation - Username Format',
                        query: `("${firstName}${lastName}" OR "${firstName}.${lastName}" OR "${firstName}_${lastName}" OR "${lastName}${firstName}")`
                    });

                    queries.push({
                        category: 'üîó Name Variation - Nicknames',
                        query: `("${firstName.substring(0, 3)}${lastName}" OR "${firstName}${lastName.substring(0, 3)}")`
                    });
                }
            }

            return queries;
        }

        // Generate Queries Function
        function generateQueries() {
            const queries = [];

            // Get all form data
            const data = {
                firstName: document.getElementById('first-name').value.trim(),
                lastName: document.getElementById('last-name').value.trim(),
                middleName: document.getElementById('middle-name').value.trim(),
                aliases: document.getElementById('aliases').value.trim(),
                dob: document.getElementById('dob').value.trim(),
                age: document.getElementById('age').value.trim(),
                email: document.getElementById('email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                username: document.getElementById('username').value.trim(),
                accountId: document.getElementById('account-id').value.trim(),
                address: document.getElementById('address').value.trim(),
                city: document.getElementById('city').value.trim(),
                state: document.getElementById('state').value.trim(),
                country: document.getElementById('country').value.trim(),
                zip: document.getElementById('zip').value.trim(),
                occupation: document.getElementById('occupation').value.trim(),
                employer: document.getElementById('employer').value.trim(),
                school: document.getElementById('school').value.trim(),
                interests: document.getElementById('interests').value.trim(),
                associates: document.getElementById('associates').value.trim(),
                ipAddress: document.getElementById('ip-address').value.trim(),
                domain: document.getElementById('domain').value.trim(),
                keywords: document.getElementById('keywords').value.trim(),
                dwTarget: document.getElementById('dw-target').value.trim(),
                dwKeywords: document.getElementById('dw-keywords').value.trim(),
                dwBitcoin: document.getElementById('dw-bitcoin').value.trim(),
                // Property (Residence/Business)
                propertyAddress: document.getElementById('property-address').value.trim(),
                propertyType: document.getElementById('property-type').value.trim(),
                propertyOwner: document.getElementById('property-owner').value.trim(),
                businessName: document.getElementById('business-name').value.trim(),
                // Vehicles
                vehicleVin: document.getElementById('vehicle-vin').value.trim(),
                licensePlate: document.getElementById('license-plate').value.trim(),
                vehicleMake: document.getElementById('vehicle-make').value.trim(),
                vehicleModel: document.getElementById('vehicle-model').value.trim(),
                vehicleYear: document.getElementById('vehicle-year').value.trim(),
                vehicleColor: document.getElementById('vehicle-color').value.trim(),
                // Misc Property
                serialNumber: document.getElementById('serial-number').value.trim(),
                miscMake: document.getElementById('misc-make').value.trim(),
                miscModel: document.getElementById('misc-model').value.trim(),
                propertyDescription: document.getElementById('property-description').value.trim()
            };

            // Build full name
            const fullName = [data.firstName, data.middleName, data.lastName].filter(x => x).join(' ');
            const personLocation = [data.city, data.state, data.country].filter(x => x).join(', ');

            // Parse comma-separated usernames and aliases for sockpuppet/multi-account analysis
            const usernames = data.username ? data.username.split(',').map(u => u.trim()).filter(u => u) : [];
            const aliases = data.aliases ? data.aliases.split(',').map(a => a.trim()).filter(a => a) : [];

            // Build search targets array (includes full name, usernames, and aliases)
            const searchTargets = [];
            if (fullName) searchTargets.push(fullName);
            searchTargets.push(...usernames);
            searchTargets.push(...aliases);

            // Base Person Searches
            if (document.getElementById('base-general').checked && fullName) {
                queries.push({
                    category: 'üë§ Person - General Search',
                    query: `"${fullName}" ${personLocation}`
                });
            }

            if (document.getElementById('base-records').checked && fullName) {
                queries.push({
                    category: 'üìÑ Person - Official Records',
                    query: `"${fullName}" (records OR documents OR official) ${personLocation}`
                });
            }

            if (document.getElementById('base-news').checked && fullName) {
                queries.push({
                    category: 'üì∞ Person - News Coverage',
                    query: `"${fullName}" (news OR article OR press OR media) ${personLocation}`
                });
            }

            if (document.getElementById('base-government').checked && fullName) {
                queries.push({
                    category: 'üèõÔ∏è Person - Government Records',
                    query: `"${fullName}" (government OR public OR court OR legal) ${personLocation}`
                });
            }

            // Catch-all people search sites
            if (document.getElementById('catch-all').checked && fullName) {
                const sites = ['truepeoplesearch.com', 'idcrawl.com', 'webmii.com', 'thatsthem.com', 'familytreenow.com'];
                sites.forEach(site => {
                    queries.push({
                        category: 'üîç People Search Sites',
                        query: `site:${site} "${fullName}" ${data.city || ''}`
                    });
                });
            }

            // Add fullName and personLocation to data object for platform queries
            data.fullName = fullName;
            data.personLocation = personLocation;

            // INDIVIDUAL PLATFORM QUERIES - Auto-generate all variations for each checked platform
            Object.keys(PLATFORMS).forEach(platformKey => {
                const checkbox = document.getElementById(`platform-${platformKey}`);
                if (checkbox && checkbox.checked) {
                    const platformQueries = generatePlatformQueries(platformKey, data);
                    queries.push(...platformQueries);
                }
            });

            // SOCK PUPPET DETECTION - Cross-reference queries
            const sockPuppetQueries = generateSockPuppetQueries(data);
            queries.push(...sockPuppetQueries);

            // USERNAME/ALIAS/ACCOUNT ID QUERIES - For sockpuppet detection and account linking
            if (usernames.length > 0) {
                usernames.forEach(username => {
                    queries.push({
                        category: 'üé≠ Username Search - All Platforms',
                        query: `"${username}" (profile OR account OR user OR @${username})`
                    });

                    queries.push({
                        category: 'üé≠ Username Search - Social Media',
                        query: `"${username}" (site:facebook.com OR site:instagram.com OR site:twitter.com OR site:tiktok.com OR site:reddit.com OR site:linkedin.com)`
                    });

                    queries.push({
                        category: 'üé≠ Username Search - Forums & Communities',
                        query: `"${username}" (site:reddit.com OR site:github.com OR site:stackoverflow.com OR site:discord.com)`
                    });

                    if (data.accountId) {
                        queries.push({
                            category: 'üîó Username + Account ID - Link Verification',
                            query: `("${username}" AND "${data.accountId}") (profile OR account OR user)`
                        });
                    }
                });
            }

            if (aliases.length > 0) {
                aliases.forEach(alias => {
                    queries.push({
                        category: 'üé≠ Alias/Nickname Search - All Platforms',
                        query: `"${alias}" (profile OR account OR user OR known as OR aka)`
                    });

                    queries.push({
                        category: 'üé≠ Alias/Nickname Search - Social Media',
                        query: `"${alias}" (site:facebook.com OR site:instagram.com OR site:twitter.com OR site:tiktok.com OR site:reddit.com)`
                    });

                    if (fullName) {
                        queries.push({
                            category: 'üîó Alias + Real Name - Identity Linking',
                            query: `("${alias}" AND "${fullName}") (profile OR account OR identity)`
                        });
                    }
                });
            }

            if (data.accountId) {
                queries.push({
                    category: 'üÜî Account ID Search - All Platforms',
                    query: `"${data.accountId}" (user OR account OR profile OR uid OR user_id OR userid)`
                });

                queries.push({
                    category: 'üÜî Account ID Search - Social Media',
                    query: `"${data.accountId}" (site:facebook.com OR site:instagram.com OR site:twitter.com OR site:tiktok.com OR site:snapchat.com)`
                });

                if (fullName) {
                    queries.push({
                        category: 'üîó Account ID + Name - Profile Verification',
                        query: `("${data.accountId}" AND "${fullName}")`
                    });
                }
            }

            // Cross-reference queries for sockpuppet detection (all usernames √ó all aliases)
            if (usernames.length > 0 && aliases.length > 0) {
                usernames.forEach(username => {
                    aliases.forEach(alias => {
                        queries.push({
                            category: 'üïµÔ∏è Sockpuppet Detection - Username √ó Alias',
                            query: `("${username}" AND "${alias}") (same OR linked OR connected OR also known as)`
                        });
                    });
                });
            }

            // AUTO-GENERATED DOCUMENT SEARCHES (using name, username, email)
            const searchTerms = [fullName, ...usernames, ...aliases, data.email].filter(x => x);
            if (searchTerms.length > 0) {
                const docTypes = [
                    {ext: 'pdf', name: 'PDF Documents'},
                    {ext: 'doc', name: 'Word Documents'},
                    {ext: 'docx', name: 'Word Documents (DOCX)'},
                    {ext: 'xls', name: 'Excel Spreadsheets'},
                    {ext: 'xlsx', name: 'Excel Spreadsheets (XLSX)'},
                    {ext: 'ppt', name: 'PowerPoint Presentations'},
                    {ext: 'pptx', name: 'PowerPoint Presentations (PPTX)'},
                    {ext: 'txt', name: 'Text Files'},
                    {ext: 'csv', name: 'CSV Files'}
                ];

                searchTerms.forEach(term => {
                    docTypes.forEach(doc => {
                        queries.push({
                            category: `üìÑ ${doc.name} - Auto-Generated`,
                            query: `filetype:${doc.ext} "${term}"`
                        });
                    });
                });

                // Financial documents
                if (fullName) {
                    queries.push({
                        category: 'üí∞ Financial Documents - Auto-Generated',
                        query: `(filetype:pdf OR filetype:xls OR filetype:xlsx) "${fullName}" (invoice OR receipt OR statement OR tax OR financial)`
                    });
                }

                // Legal documents
                if (fullName) {
                    queries.push({
                        category: '‚öñÔ∏è Legal Documents - Auto-Generated',
                        query: `(filetype:pdf OR filetype:doc OR filetype:docx) "${fullName}" (contract OR agreement OR court OR legal OR compliance)`
                    });
                }
            }

            // AUTO-GENERATED PROPERTY & VEHICLE SEARCHES
            if (data.vehicleVin) {
                queries.push({
                    category: 'üöó Vehicle VIN - Auto-Generated',
                    query: `"${data.vehicleVin}" (vehicle OR VIN OR "vehicle identification" OR registration)`
                });
                queries.push({
                    category: 'üöó Vehicle VIN - Marketplaces',
                    query: `"${data.vehicleVin}" (site:ebay.com OR site:craigslist.org OR site:facebook.com OR site:offerup.com OR site:autotrader.com)`
                });
            }

            if (data.licensePlate) {
                const plateLocation = data.state || data.city || '';
                queries.push({
                    category: 'üöó License Plate - Auto-Generated',
                    query: `"${data.licensePlate}" ${plateLocation} (license OR plate OR vehicle OR registration)`
                });
                queries.push({
                    category: 'üöó License Plate - Images',
                    query: `"${data.licensePlate}" ${plateLocation} (photo OR image OR picture OR spotted)`
                });
            }

            if (data.vehicleMake && data.vehicleModel) {
                const vehicleDesc = `${data.vehicleYear || ''} ${data.vehicleMake} ${data.vehicleModel} ${data.vehicleColor || ''}`.trim();
                const searchLocation = [data.city, data.state].filter(x => x).join(', ');

                queries.push({
                    category: 'üöó Vehicle Make/Model - For Sale',
                    query: `"${vehicleDesc}" ${searchLocation} (for sale OR selling OR forsale)`
                });
                queries.push({
                    category: 'üöó Vehicle Make/Model - Marketplaces',
                    query: `"${vehicleDesc}" ${searchLocation} (site:craigslist.org OR site:facebook.com OR site:offerup.com OR site:letgo.com)`
                });
            }

            if (data.serialNumber) {
                queries.push({
                    category: 'üî¢ Serial Number - Auto-Generated',
                    query: `"${data.serialNumber}" ${data.propertyDescription || ''} (serial OR "serial number" OR product OR item)`
                });
                queries.push({
                    category: 'üî¢ Serial Number - Marketplaces',
                    query: `"${data.serialNumber}" (site:ebay.com OR site:craigslist.org OR site:facebook.com OR site:offerup.com OR site:mercari.com)`
                });
                queries.push({
                    category: 'üî¢ Serial Number - Stolen Property',
                    query: `"${data.serialNumber}" (stolen OR missing OR lost OR report OR police)`
                });
            }

            if (data.propertyAddress) {
                const ownerName = data.propertyOwner || fullName || '';
                queries.push({
                    category: 'üè† Property Address - Auto-Generated',
                    query: `"${data.propertyAddress}" ${ownerName ? `"${ownerName}"` : ''} (property OR real estate OR ownership OR deed OR tax)`
                });
                queries.push({
                    category: 'üè† Property Address - Public Records',
                    query: `"${data.propertyAddress}" ${data.city || ''} ${data.state || ''} (site:zillow.com OR site:realtor.com OR site:trulia.com OR site:redfin.com)`
                });
            }

            if (data.businessName && data.propertyAddress) {
                queries.push({
                    category: 'üè¢ Business at Property - Auto-Generated',
                    query: `"${data.businessName}" "${data.propertyAddress}" (business OR company OR LLC OR corporation)`
                });
            }

            if (data.miscMake && data.miscModel) {
                const itemDesc = `${data.miscMake} ${data.miscModel}`.trim();
                queries.push({
                    category: 'üì¶ Misc Property Make/Model - Marketplaces',
                    query: `"${itemDesc}" ${data.serialNumber || ''} (site:ebay.com OR site:craigslist.org OR site:facebook.com OR site:offerup.com)`
                });
            }

            // International Domains
            if (document.getElementById('domains-all-global').checked && fullName) {
                const platforms = [
                    {site: 'facebook.com', name: 'Facebook'},
                    {site: 'instagram.com', name: 'Instagram'},
                    {site: 'twitter.com', name: 'Twitter'},
                    {site: 'tiktok.com', name: 'TikTok'},
                    {site: 'snapchat.com', name: 'Snapchat'}
                ];

                const searchTarget = fullName || data.username;
                if (searchTarget) {
                    platforms.forEach(platform => {
                        // 1. Basic profile search
                        queries.push({
                            category: `üì± ${platform.name} - Profile`,
                            query: `site:${platform.site} "${searchTarget}"`
                        });

                        // 2. Posts/Status search
                        queries.push({
                            category: `üì± ${platform.name} - Posts`,
                            query: `site:${platform.site} "${searchTarget}" (post OR status OR update OR published)`
                        });

                        // 3. Comments/Replies
                        queries.push({
                            category: `üì± ${platform.name} - Comments`,
                            query: `site:${platform.site} "${searchTarget}" (comment OR reply OR responded)`
                        });

                        // 4. Photos/Media
                        queries.push({
                            category: `üì± ${platform.name} - Photos/Media`,
                            query: `site:${platform.site} "${searchTarget}" (photo OR image OR video OR media)`
                        });

                        // 5. Friends/Followers
                        queries.push({
                            category: `üì± ${platform.name} - Connections`,
                            query: `site:${platform.site} "${searchTarget}" (friend OR follower OR following OR connection)`
                        });

                        // 6. Groups/Pages/Communities
                        if (platform.site === 'facebook.com') {
                            queries.push({
                                category: `üì± ${platform.name} - Groups/Pages`,
                                query: `site:${platform.site} "${searchTarget}" (group OR page OR community)`
                            });
                        }

                        // 7. Location-based (if location provided)
                        if (personLocation) {
                            queries.push({
                                category: `üì± ${platform.name} - Location`,
                                query: `site:${platform.site} "${searchTarget}" "${personLocation}"`
                            });
                        }
                    });
                }
            }

            // Professional Networks (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('social-professional').checked && fullName) {
                const platforms = [
                    {site: 'linkedin.com', name: 'LinkedIn'},
                    {site: 'indeed.com', name: 'Indeed'},
                    {site: 'glassdoor.com', name: 'Glassdoor'}
                ];

                platforms.forEach(platform => {
                    // Basic profile
                    queries.push({
                        category: `üíº ${platform.name} - Profile`,
                        query: `site:${platform.site} "${fullName}" ${data.occupation || data.employer || ''}`
                    });

                    // Posts/Activity
                    queries.push({
                        category: `üíº ${platform.name} - Activity`,
                        query: `site:${platform.site} "${fullName}" (post OR article OR activity OR shared)`
                    });

                    // Connections/Network
                    queries.push({
                        category: `üíº ${platform.name} - Network`,
                        query: `site:${platform.site} "${fullName}" (connection OR colleague OR recommendation)`
                    });

                    // Work history
                    if (data.employer) {
                        queries.push({
                            category: `üíº ${platform.name} - Employment`,
                            query: `site:${platform.site} "${fullName}" "${data.employer}"`
                        });
                    }
                });
            }

            // Video Platforms (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('social-video').checked && (fullName || data.username)) {
                const videoPlatforms = [
                    {site: 'youtube.com', name: 'YouTube'},
                    {site: 'twitch.tv', name: 'Twitch'},
                    {site: 'vimeo.com', name: 'Vimeo'},
                    {site: 'rumble.com', name: 'Rumble'}
                ];

                const searchTarget = fullName || data.username;
                videoPlatforms.forEach(platform => {
                    // Channel/Profile
                    queries.push({
                        category: `üìπ ${platform.name} - Channel`,
                        query: `site:${platform.site} "${searchTarget}"`
                    });

                    // Videos/Content
                    queries.push({
                        category: `üìπ ${platform.name} - Videos`,
                        query: `site:${platform.site} "${searchTarget}" (video OR stream OR uploaded)`
                    });

                    // Comments
                    queries.push({
                        category: `üìπ ${platform.name} - Comments`,
                        query: `site:${platform.site} "${searchTarget}" (comment OR replied)`
                    });

                    // Subscribers/Followers
                    queries.push({
                        category: `üìπ ${platform.name} - Subscribers`,
                        query: `site:${platform.site} "${searchTarget}" (subscriber OR follower OR following)`
                    });
                });
            }

            // Gaming Platforms (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('social-gaming').checked && data.username) {
                const gamingPlatforms = [
                    {site: 'discord.com', name: 'Discord'},
                    {site: 'steamcommunity.com', name: 'Steam'},
                    {site: 'xbox.com', name: 'Xbox Live'},
                    {site: 'playstation.com', name: 'PlayStation Network'}
                ];

                gamingPlatforms.forEach(platform => {
                    // Profile/Account
                    queries.push({
                        category: `üéÆ ${platform.name} - Profile`,
                        query: `site:${platform.site} "${data.username}"`
                    });

                    // Activity/Games
                    queries.push({
                        category: `üéÆ ${platform.name} - Activity`,
                        query: `site:${platform.site} "${data.username}" (game OR playing OR activity)`
                    });

                    // Friends/Community
                    queries.push({
                        category: `üéÆ ${platform.name} - Friends`,
                        query: `site:${platform.site} "${data.username}" (friend OR clan OR guild OR team)`
                    });
                });
            }

            // Messaging Apps (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('social-messaging').checked) {
                const messagingApps = [
                    {site: 'web.whatsapp.com', name: 'WhatsApp'},
                    {site: 'telegram.org', name: 'Telegram'},
                    {site: 'signal.org', name: 'Signal'},
                    {site: 'viber.com', name: 'Viber'}
                ];

                const searchTarget = data.phone || data.username || fullName;
                if (searchTarget) {
                    messagingApps.forEach(platform => {
                        queries.push({
                            category: `üí¨ ${platform.name} - Search`,
                            query: `site:${platform.site} "${searchTarget}"`
                        });

                        queries.push({
                            category: `üí¨ ${platform.name} - Groups/Channels`,
                            query: `"${searchTarget}" (${platform.name} OR "group chat" OR channel)`
                        });
                    });
                }
            }

            // Dating Platforms (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('social-dating').checked) {
                const datingPlatforms = [
                    {site: 'tinder.com', name: 'Tinder'},
                    {site: 'bumble.com', name: 'Bumble'},
                    {site: 'match.com', name: 'Match'},
                    {site: 'hinge.co', name: 'Hinge'},
                    {site: 'okcupid.com', name: 'OKCupid'}
                ];

                const searchTarget = fullName || data.username;
                if (searchTarget) {
                    datingPlatforms.forEach(platform => {
                        queries.push({
                            category: `‚ù§Ô∏è ${platform.name} - Profile`,
                            query: `site:${platform.site} "${searchTarget}"`
                        });

                        if (data.age || personLocation) {
                            queries.push({
                                category: `‚ù§Ô∏è ${platform.name} - Detailed`,
                                query: `"${searchTarget}" ${platform.name} ${data.age || ''} ${personLocation || ''}`
                            });
                        }
                    });
                }
            }

            // Forums & Communities (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('social-forums').checked) {
                const forums = [
                    {site: 'reddit.com', name: 'Reddit'},
                    {site: '4chan.org', name: '4chan'},
                    {site: '8kun.top', name: '8kun'},
                    {site: 'quora.com', name: 'Quora'}
                ];

                const searchTarget = data.username || fullName;
                if (searchTarget) {
                    forums.forEach(platform => {
                        // User profile
                        queries.push({
                            category: `üí≠ ${platform.name} - User`,
                            query: `site:${platform.site} "${searchTarget}"`
                        });

                        // Posts/Comments
                        queries.push({
                            category: `üí≠ ${platform.name} - Posts`,
                            query: `site:${platform.site} "${searchTarget}" (post OR comment OR thread)`
                        });

                        // Subreddits/Communities (Reddit specific)
                        if (platform.site === 'reddit.com') {
                            queries.push({
                                category: `üí≠ ${platform.name} - Subreddits`,
                                query: `site:reddit.com/r/ "${searchTarget}"`
                            });
                        }
                    });
                }
            }

            // Creative Platforms (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('social-creative').checked) {
                const creativePlatforms = [
                    {site: 'pinterest.com', name: 'Pinterest'},
                    {site: 'deviantart.com', name: 'DeviantArt'},
                    {site: 'behance.net', name: 'Behance'},
                    {site: 'dribbble.com', name: 'Dribbble'}
                ];

                const searchTarget = data.username || fullName;
                if (searchTarget) {
                    creativePlatforms.forEach(platform => {
                        // Profile/Portfolio
                        queries.push({
                            category: `üé® ${platform.name} - Profile`,
                            query: `site:${platform.site} "${searchTarget}"`
                        });

                        // Works/Creations
                        queries.push({
                            category: `üé® ${platform.name} - Works`,
                            query: `site:${platform.site} "${searchTarget}" (portfolio OR artwork OR design OR created)`
                        });

                        // Followers/Following
                        queries.push({
                            category: `üé® ${platform.name} - Network`,
                            query: `site:${platform.site} "${searchTarget}" (follower OR following OR collection)`
                        });
                    });
                }
            }

            // International Platforms (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('social-international').checked) {
                const intlPlatforms = [
                    {site: 'vk.com', name: 'VK (Russia)'},
                    {site: 'wechat.com', name: 'WeChat (China)'},
                    {site: 'qq.com', name: 'QQ (China)'},
                    {site: 'weibo.com', name: 'Weibo (China)'},
                    {site: 'line.me', name: 'LINE (Japan)'}
                ];

                const searchTarget = data.username || fullName;
                if (searchTarget) {
                    intlPlatforms.forEach(platform => {
                        // Profile
                        queries.push({
                            category: `üåè ${platform.name} - Profile`,
                            query: `site:${platform.site} "${searchTarget}"`
                        });

                        // Posts/Activity
                        queries.push({
                            category: `üåè ${platform.name} - Activity`,
                            query: `site:${platform.site} "${searchTarget}" (post OR status OR message)`
                        });
                    });
                }
            }

            // Alternative Platforms (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('social-alt').checked) {
                const altPlatforms = [
                    {site: 'parler.com', name: 'Parler'},
                    {site: 'gab.com', name: 'Gab'},
                    {site: 'truthsocial.com', name: 'Truth Social'},
                    {site: 'gettr.com', name: 'Gettr'}
                ];

                const searchTarget = data.username || fullName;
                if (searchTarget) {
                    altPlatforms.forEach(platform => {
                        // Profile
                        queries.push({
                            category: `üó£Ô∏è ${platform.name} - Profile`,
                            query: `site:${platform.site} "${searchTarget}"`
                        });

                        // Posts/Truth/Gabs
                        queries.push({
                            category: `üó£Ô∏è ${platform.name} - Posts`,
                            query: `site:${platform.site} "${searchTarget}" (post OR truth OR gab OR gettr)`
                        });

                        // Followers
                        queries.push({
                            category: `üó£Ô∏è ${platform.name} - Followers`,
                            query: `site:${platform.site} "${searchTarget}" (follower OR following)`
                        });
                    });
                }
            }

            // International Domains
            if (document.getElementById('domains-all-global').checked && fullName) {
                queries.push({
                    category: 'üåç International Search - All Domains',
                    query: `"${fullName}" (site:.uk OR site:.ca OR site:.au OR site:.de OR site:.fr OR site:.it OR site:.es OR site:.jp OR site:.cn OR site:.in)`
                });
            }

            // Document Searches
            if (document.getElementById('doc-all').checked && fullName) {
                queries.push({
                    category: 'üìÑ Documents - All Types',
                    query: `"${fullName}" (filetype:pdf OR filetype:doc OR filetype:docx OR filetype:xls OR filetype:xlsx OR filetype:ppt OR filetype:pptx)`
                });
            }

            if (document.getElementById('doc-financial').checked && fullName) {
                queries.push({
                    category: 'üí∞ Documents - Financial',
                    query: `"${fullName}" (filetype:pdf OR filetype:xls) (financial OR invoice OR statement OR tax)`
                });
            }

            // Exposed Files
            if (document.getElementById('exposed-all').checked) {
                queries.push({
                    category: '‚ö†Ô∏è Exposed Files - All',
                    query: `${data.domain || data.email || fullName} (inurl:.env OR inurl:config OR inurl:.git OR inurl:backup OR inurl:.sql OR inurl:dump)`
                });
            }

            if (document.getElementById('exposed-databases').checked) {
                queries.push({
                    category: 'üóÑÔ∏è Exposed Databases',
                    query: `${data.domain || 'site:*'} (inurl:phpmyadmin OR inurl:mongodb OR inurl:elasticsearch OR filetype:sql)`
                });
            }

            // Sensitive Information
            if (document.getElementById('sensitive-all').checked && fullName) {
                queries.push({
                    category: 'üö® Sensitive Information',
                    query: `"${fullName}" (SSN OR "social security" OR password OR "credit card" OR "api key")`
                });
            }

            // Dark Web (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('darkweb-all').checked && (data.dwTarget || fullName)) {
                const dwTarget = data.dwTarget || fullName;
                const keywords = data.dwKeywords || '';

                // Main dark web search
                queries.push({
                    category: 'üï≥Ô∏è Dark Web - General',
                    query: `site:.onion "${dwTarget}" ${keywords}`
                });

                // Marketplaces
                queries.push({
                    category: 'üï≥Ô∏è Dark Web - Marketplaces',
                    query: `site:.onion "${dwTarget}" (market OR shop OR vendor OR seller OR listing) ${keywords}`
                });

                // Forums & Communities
                queries.push({
                    category: 'üï≥Ô∏è Dark Web - Forums',
                    query: `site:.onion "${dwTarget}" (forum OR thread OR post OR discussion) ${keywords}`
                });

                // User profiles
                queries.push({
                    category: 'üï≥Ô∏è Dark Web - Profiles',
                    query: `site:.onion "${dwTarget}" (profile OR user OR account OR member) ${keywords}`
                });

                // Transactions/Feedback
                queries.push({
                    category: 'üï≥Ô∏è Dark Web - Transactions',
                    query: `site:.onion "${dwTarget}" (transaction OR feedback OR review OR rating) ${keywords}`
                });

                // Tor search engines
                const torEngines = ['ahmia.fi', 'torch.onion', 'notevil.onion', 'phobos.onion'];
                torEngines.forEach(engine => {
                    queries.push({
                        category: 'üï≥Ô∏è Tor Search Engines',
                        query: `site:${engine} "${dwTarget}" ${keywords}`
                    });
                });
            }

            // Dark Web - Marketplaces
            if (document.getElementById('darkweb-marketplaces').checked && (data.dwTarget || fullName)) {
                const dwTarget = data.dwTarget || fullName;
                queries.push({
                    category: 'üõí Dark Web Marketplaces - Vendors',
                    query: `site:.onion "${dwTarget}" (vendor OR seller OR merchant OR dealer)`
                });

                queries.push({
                    category: 'üõí Dark Web Marketplaces - Products',
                    query: `site:.onion "${dwTarget}" (product OR listing OR item OR goods)`
                });
            }

            // Dark Web - Forums
            if (document.getElementById('darkweb-forums').checked && (data.dwTarget || fullName)) {
                const dwTarget = data.dwTarget || fullName;
                queries.push({
                    category: 'üí¨ Dark Web Forums - Posts',
                    query: `site:.onion "${dwTarget}" (hacking OR exploit OR breach OR leaked)`
                });

                queries.push({
                    category: 'üí¨ Dark Web Forums - Trading',
                    query: `site:.onion "${dwTarget}" (trade OR sell OR buy OR exchange)`
                });
            }

            // Cryptocurrency Tracking (AUTO-GENERATES ALL VARIATIONS)
            if (document.getElementById('darkweb-crypto').checked && data.dwBitcoin) {
                // Bitcoin blockchain
                queries.push({
                    category: '‚Çø Crypto - Bitcoin',
                    query: `"${data.dwBitcoin}" (bitcoin OR BTC OR wallet OR address)`
                });

                // Transactions
                queries.push({
                    category: '‚Çø Crypto - Transactions',
                    query: `"${data.dwBitcoin}" (transaction OR transfer OR sent OR received OR blockchain)`
                });

                // Exchanges & Mixers
                queries.push({
                    category: '‚Çø Crypto - Exchanges',
                    query: `"${data.dwBitcoin}" (exchange OR mixer OR tumbler OR laundering)`
                });

                // Dark web wallets
                queries.push({
                    category: '‚Çø Crypto - Dark Web',
                    query: `site:.onion "${data.dwBitcoin}"`
                });

                // Other cryptocurrencies
                queries.push({
                    category: '‚Çø Crypto - Altcoins',
                    query: `"${data.dwBitcoin}" (monero OR ethereum OR litecoin OR cryptocurrency)`
                });
            }

            // Dark Web - Tor Engines
            if (document.getElementById('darkweb-engines').checked && (data.dwTarget || fullName)) {
                const dwTarget = data.dwTarget || fullName;
                const engines = [
                    {name: 'Ahmia', site: 'ahmia.fi'},
                    {name: 'Torch', site: 'torch'},
                    {name: 'notEvil', site: 'hss3uro2hsxfogfq.onion'},
                    {name: 'Phobos', site: 'phobos'}
                ];

                engines.forEach(engine => {
                    queries.push({
                        category: `üîç Tor Engine - ${engine.name}`,
                        query: `"${dwTarget}" ${data.dwKeywords || ''} site:${engine.site}`
                    });
                });
            }

            // Criminal Records
            if (document.getElementById('criminal-all-records').checked && fullName) {
                queries.push({
                    category: 'üöî Criminal Records - All',
                    query: `"${fullName}" (arrest OR mugshot OR warrant OR court OR "criminal record") ${personLocation}`
                });
            }

            if (document.getElementById('crime-organized').checked && fullName) {
                queries.push({
                    category: 'üé≠ Organized Crime',
                    query: `"${fullName}" (gang OR cartel OR mafia OR "organized crime" OR syndicate)`
                });
            }

            // Property & Assets
            if (document.getElementById('property-real-estate').checked && fullName) {
                queries.push({
                    category: 'üè° Real Estate Records',
                    query: `"${fullName}" (property OR "real estate" OR deed OR title OR owner) ${data.address || personLocation}`
                });
            }

            if (document.getElementById('property-vehicles').checked && fullName) {
                queries.push({
                    category: 'üöó Vehicle Records',
                    query: `"${fullName}" (vehicle OR car OR VIN OR registration OR title OR DMV) ${data.state || ''}`
                });
            }

            // Technical Searches
            if (document.getElementById('tech-ip-all').checked && data.ipAddress) {
                queries.push({
                    category: 'üåê IP Investigation',
                    query: `"${data.ipAddress}" (WHOIS OR geolocation OR "reverse DNS" OR ASN)`
                });
            }

            if (document.getElementById('tech-domain-all').checked && data.domain) {
                queries.push({
                    category: 'üåê Domain Investigation',
                    query: `site:${data.domain} OR inurl:${data.domain} (WHOIS OR subdomain OR history)`
                });
            }

            if (document.getElementById('vuln-all').checked && data.domain) {
                queries.push({
                    category: '‚ö†Ô∏è Vulnerability Scan',
                    query: `site:${data.domain} (inurl:admin OR inurl:login OR inurl:wp-admin OR inurl:phpmyadmin OR inurl:.git)`
                });
            }

            // Display results
            displayQueries(queries);
        }

        function displayQueries(queries) {
            const container = document.getElementById('queries-container');
            const resultsDisplay = document.getElementById('results-display');

            if (queries.length === 0) {
                container.innerHTML = '<p style="color: #888;">No queries generated. Please fill in data and select checkboxes.</p>';
                return;
            }

            resultsDisplay.classList.add('active');

            let html = '';
            queries.forEach(q => {
                html += `
                    <div class="query-item">
                        <div class="query-category">${q.category}</div>
                        <div class="query-text">${q.query}</div>
                    </div>
                `;
            });

            container.innerHTML = html;
            showTab('results');
        }

        function copyAllQueries() {
            const queries = document.querySelectorAll('.query-text');
            let text = '';
            queries.forEach(q => {
                text += q.textContent + '\n\n';
            });

            navigator.clipboard.writeText(text).then(() => {
                alert('‚úÖ All queries copied to clipboard!');
            });
        }

        // REMOVED: saveInvestigation - Users now only save via "Save inputs as file" workflow
        // function saveInvestigation() { ... }

        function getAllFormData() {
            return {
                // Person Information
                firstName: document.getElementById('first-name').value,
                lastName: document.getElementById('last-name').value,
                middleName: document.getElementById('middle-name').value,
                aliases: document.getElementById('aliases').value,
                dob: document.getElementById('dob').value,
                age: document.getElementById('age').value,

                // Contact & Location
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                username: document.getElementById('username').value,
                address: document.getElementById('address').value,
                city: document.getElementById('city').value,
                state: document.getElementById('state').value,
                country: document.getElementById('country').value,
                zip: document.getElementById('zip').value,

                // Professional & Education
                occupation: document.getElementById('occupation').value,
                employer: document.getElementById('employer').value,
                school: document.getElementById('school').value,
                interests: document.getElementById('interests').value,

                // Investigation Social Media Accounts
                investigationSocialAccounts: collectInvestigationSocialAccounts()
            };
        }

        function getGeneratedQueries() {
            const queries = [];
            document.querySelectorAll('.query-item').forEach(item => {
                queries.push({
                    category: item.querySelector('.query-category').textContent,
                    query: item.querySelector('.query-text').textContent
                });
            });
            return queries;
        }

        function loadFiles() {
            const fileList = document.getElementById('file-list');
            const savedSubjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');

            if (savedSubjects.length === 0) {
                fileList.innerHTML = '<p style="color: #888;">No saved subject files yet. Use "Save inputs as file" in the User Input tab to create files.</p>';
                return;
            }

            let html = '<p style="color: #4bff21; margin-bottom: 10px; font-size: 0.9em;">üìÅ Saved Subject Profiles:</p>';
            savedSubjects.forEach((subject, index) => {
                const subjectName = subject.name || subject.nickname || 'Unknown Subject';
                const category = subject.category ? ` (${subject.category})` : '';
                html += `
                    <div class="file-item">
                        <div class="file-name">${subjectName}${category} - ${new Date(subject.createdAt).toLocaleDateString()}</div>
                        <div class="file-actions">
                            <button class="file-btn" onclick="viewSubjectDetails('${subject.id}')">View</button>
                            <button class="file-btn" onclick="exportSubjectAsMarkdown('${subject.id}')">Export</button>
                            <button class="file-btn" onclick="deleteSubjectFromFiles('${subject.id}')">Delete</button>
                        </div>
                    </div>
                `;
            });

            fileList.innerHTML = html;
        }

        // Delete subject from file list
        function deleteSubjectFromFiles(subjectId) {
            if (!confirm('Are you sure you want to delete this subject profile?')) return;

            let subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');
            subjects = subjects.filter(s => s.id !== subjectId);
            localStorage.setItem('daisys_subjects', JSON.stringify(subjects));

            loadFiles();
            updateCategoryFilter();
            alert('‚úÖ Subject profile deleted.');
        }

        // REMOVED: openFile - No longer needed with subject-only workflow
        function openFile(index) {
            const savedFiles = JSON.parse(localStorage.getItem('osintFiles') || '[]');
            const file = savedFiles[index];

            if (!file) return;

            // Load data into form
            document.getElementById('case-name').value = file.name || '';
            document.getElementById('investigation-notes').value = file.notes || '';

            if (file.data) {
                // Load regular form fields
                if (file.data.firstName) document.getElementById('first-name').value = file.data.firstName;
                if (file.data.lastName) document.getElementById('last-name').value = file.data.lastName;
                if (file.data.middleName) document.getElementById('middle-name').value = file.data.middleName;
                if (file.data.aliases) document.getElementById('aliases').value = file.data.aliases;
                if (file.data.dob) document.getElementById('dob').value = file.data.dob;
                if (file.data.age) document.getElementById('age').value = file.data.age;
                if (file.data.email) document.getElementById('email').value = file.data.email;
                if (file.data.phone) document.getElementById('phone').value = file.data.phone;
                if (file.data.username) document.getElementById('username').value = file.data.username;
                if (file.data.address) document.getElementById('address').value = file.data.address;
                if (file.data.city) document.getElementById('city').value = file.data.city;
                if (file.data.state) document.getElementById('state').value = file.data.state;
                if (file.data.country) document.getElementById('country').value = file.data.country;
                if (file.data.zip) document.getElementById('zip').value = file.data.zip;
                if (file.data.occupation) document.getElementById('occupation').value = file.data.occupation;
                if (file.data.employer) document.getElementById('employer').value = file.data.employer;
                if (file.data.school) document.getElementById('school').value = file.data.school;
                if (file.data.interests) document.getElementById('interests').value = file.data.interests;

                // Load investigation social accounts if present
                if (file.data.investigationSocialAccounts && Array.isArray(file.data.investigationSocialAccounts) && file.data.investigationSocialAccounts.length > 0) {
                    const invContainer = document.getElementById('investigation-social-accounts-container');
                    invContainer.innerHTML = '';
                    investigationSocialAccountCounter = 0;

                    file.data.investigationSocialAccounts.forEach(account => {
                        investigationSocialAccountCounter++;
                        const entryDiv = document.createElement('div');
                        entryDiv.className = 'social-account-entry';
                        entryDiv.id = `inv-social-entry-${investigationSocialAccountCounter}`;
                        entryDiv.innerHTML = `
                            ${investigationSocialAccountCounter > 1 ? '<hr style="border-color: #00f0ff; margin: 15px 0;">' : ''}
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Platform:</label>
                                    <input type="text" class="inv-social-platform" placeholder="Facebook, Instagram, Twitter..." data-entry="${investigationSocialAccountCounter}" value="${account.platform || ''}">
                                </div>
                                <div class="form-group">
                                    <label>Username/Handle:</label>
                                    <input type="text" class="inv-social-username" placeholder="@username" data-entry="${investigationSocialAccountCounter}" value="${account.username || ''}">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Account ID:</label>
                                    <input type="text" class="inv-social-account-id" placeholder="Numeric ID or unique identifier" data-entry="${investigationSocialAccountCounter}" value="${account.accountId || ''}">
                                </div>
                                <div class="form-group">
                                    <label>Profile URL:</label>
                                    <input type="text" class="inv-social-url" placeholder="https://..." data-entry="${investigationSocialAccountCounter}" value="${account.url || ''}">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Display Name:</label>
                                    <input type="text" class="inv-social-display-name" placeholder="Name shown on profile" data-entry="${investigationSocialAccountCounter}" value="${account.displayName || ''}">
                                </div>
                            </div>
                            ${investigationSocialAccountCounter > 1 ? `<button class="btn" style="background-color: #ff0000; margin-top: 5px;" onclick="removeInvestigationSocialAccount(${investigationSocialAccountCounter})">‚ùå Remove This Account</button>` : ''}
                        `;
                        invContainer.appendChild(entryDiv);
                    });
                }
            }

            alert(`‚úÖ Loaded investigation: ${file.name}`);
            showTab('user-input');
        }

        function deleteFile(index) {
            if (!confirm('Are you sure you want to delete this file?')) return;

            let savedFiles = JSON.parse(localStorage.getItem('osintFiles') || '[]');
            savedFiles.splice(index, 1);
            localStorage.setItem('osintFiles', JSON.stringify(savedFiles));
            loadFiles();
        }

        // Get storage directory based on user selection
        function getStorageLocation() {
            const selection = document.getElementById('storage-location').value;

            if (typeof cordova === 'undefined' || !cordova.file) {
                console.log('Cordova file plugin not available, using default');
                return null;
            }

            switch(selection) {
                case 'downloads':
                    return cordova.file.externalRootDirectory + 'Download/';
                case 'documents':
                    return cordova.file.externalRootDirectory + 'Documents/';
                case 'daisystracker':
                    return cordova.file.externalDataDirectory || cordova.file.dataDirectory;
                case 'custom':
                    return 'custom'; // Will trigger custom picker
                default:
                    return cordova.file.externalRootDirectory + 'Download/';
            }
        }

        // Create folder on device file system
        function createFolderOnDevice() {
            const folderName = document.getElementById('folder-name').value.trim();
            if (!folderName) {
                alert('‚ö†Ô∏è Please enter a folder name');
                return;
            }

            const baseDir = getStorageLocation();

            if (!baseDir) {
                // Fallback to localStorage if Cordova not available
                createFolderLocalStorage(folderName);
                return;
            }

            if (baseDir === 'custom') {
                alert('üìÇ Custom location picker will be available in the full mobile app. For now, choose Downloads, Documents, or App Storage.');
                return;
            }

            // Create folder using Cordova File plugin
            window.resolveLocalFileSystemURL(baseDir, function(dirEntry) {
                dirEntry.getDirectory(folderName, { create: true, exclusive: false }, function(newDirEntry) {
                    alert(`‚úÖ Folder "${folderName}" created at:\n${newDirEntry.nativeURL}`);
                    document.getElementById('folder-name').value = '';

                    // Also save to localStorage for tracking
                    let folders = JSON.parse(localStorage.getItem('osintFolders') || '[]');
                    const folderInfo = {
                        name: folderName,
                        path: newDirEntry.nativeURL,
                        created: new Date().toISOString()
                    };
                    folders.push(folderInfo);
                    localStorage.setItem('osintFolders', JSON.stringify(folders));
                }, function(error) {
                    alert(`‚ùå Error creating folder: ${error.code}`);
                });
            }, function(error) {
                alert(`‚ùå Error accessing storage: ${error.code}`);
            });
        }

        // Fallback: Create folder in localStorage (old method)
        function createFolderLocalStorage(folderName) {
            let folders = JSON.parse(localStorage.getItem('osintFolders') || '[]');
            if (!folders.some(f => f.name === folderName || f === folderName)) {
                folders.push({
                    name: folderName,
                    path: 'localStorage',
                    created: new Date().toISOString()
                });
                localStorage.setItem('osintFolders', JSON.stringify(folders));
                alert(`‚úÖ Folder "${folderName}" created in app storage!`);
                document.getElementById('folder-name').value = '';
            } else {
                alert('‚ö†Ô∏è Folder already exists');
            }
        }

        // Old function kept for compatibility
        function createFolder() {
            createFolderOnDevice();
        }

        function exportMarkdown() {
            const caseName = document.getElementById('case-name').value.trim() || 'Investigation';
            const notes = document.getElementById('investigation-notes').value.trim();
            const queries = getGeneratedQueries();

            let markdown = `# OSINT Investigation: ${caseName}\n\n`;
            markdown += `**Date:** ${new Date().toLocaleDateString()}\n\n`;

            if (notes) {
                markdown += `## Investigation Notes\n\n${notes}\n\n`;
            }

            markdown += `## Generated Queries\n\n`;
            queries.forEach(q => {
                markdown += `### ${q.category}\n\`\`\`\n${q.query}\n\`\`\`\n\n`;
            });

            // Download as file
            const blob = new Blob([markdown], {type: 'text/markdown'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${caseName.replace(/\s+/g, '_')}_${Date.now()}.md`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function clearAll() {
            if (!confirm('Are you sure you want to clear all data?')) return;

            document.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"], textarea').forEach(el => {
                el.value = '';
            });

            document.querySelectorAll('input[type="checkbox"]').forEach(el => {
                el.checked = false;
            });

            // Re-check default checkboxes
            document.getElementById('base-general').checked = true;
            document.getElementById('base-records').checked = true;
            document.getElementById('base-news').checked = true;
            document.getElementById('base-government').checked = true;
            document.getElementById('social-all-major').checked = true;

            document.getElementById('queries-container').innerHTML = '';
            document.getElementById('results-display').classList.remove('active');
        }

        // ============================================================================
        // SUBJECT MANAGEMENT FUNCTIONS
        // ============================================================================

        let socialAccountCounter = 1;
        let subjectPhotos = []; // Array to store photo data URIs
        let currentEditingSubjectId = null;

        // Add another social media account entry
        function addSocialAccount() {
            socialAccountCounter++;
            const container = document.getElementById('social-accounts-container');
            const newEntry = document.createElement('div');
            newEntry.className = 'social-account-entry';
            newEntry.id = `social-entry-${socialAccountCounter}`;
            newEntry.innerHTML = `
                <hr style="border-color: #4bff21; margin: 15px 0;">
                <div class="form-row">
                    <div class="form-group">
                        <label>Platform:</label>
                        <input type="text" class="social-platform" placeholder="e.g., Facebook, Instagram, TikTok" data-entry="${socialAccountCounter}">
                    </div>
                    <div class="form-group">
                        <label>Username/Handle:</label>
                        <input type="text" class="social-username" placeholder="@username" data-entry="${socialAccountCounter}">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Account ID/URL:</label>
                        <input type="text" class="social-account-id" placeholder="Profile URL or account ID" data-entry="${socialAccountCounter}">
                    </div>
                    <div class="form-group">
                        <label>Display Name:</label>
                        <input type="text" class="social-display-name" placeholder="Name shown on profile" data-entry="${socialAccountCounter}">
                    </div>
                </div>
                <button class="btn" style="background-color: #ff0000; margin-top: 5px;" onclick="removeSocialAccount(${socialAccountCounter})">‚ùå Remove This Account</button>
            `;
            container.appendChild(newEntry);
        }

        // Remove social media account entry
        function removeSocialAccount(entryId) {
            const entry = document.getElementById(`social-entry-${entryId}`);
            if (entry) {
                entry.remove();
            }
        }

        // Handle photo selection from camera roll
        function handlePhotoSelection(event) {
            const files = event.target.files;
            const preview = document.getElementById('subject-photos-preview');

            for (let i = 0; i < files.length; i++) {
                const file = files[i];

                // Check file type
                if (!file.type.match('image/jpeg') && !file.type.match('image/png')) {
                    alert(`File "${file.name}" is not a JPEG or PNG image. Skipped.`);
                    continue;
                }

                // Read file as data URI
                const reader = new FileReader();
                reader.onload = function(e) {
                    const dataUri = e.target.result;
                    subjectPhotos.push({
                        filename: file.name,
                        dataUri: dataUri,
                        timestamp: new Date().toISOString()
                    });

                    // Create preview element
                    const photoDiv = document.createElement('div');
                    photoDiv.style.cssText = 'position: relative; border: 2px solid #4bff21; border-radius: 5px; overflow: hidden;';
                    photoDiv.innerHTML = `
                        <img src="${dataUri}" style="width: 100%; height: 150px; object-fit: cover;">
                        <button onclick="removePhoto(${subjectPhotos.length - 1})" style="position: absolute; top: 5px; right: 5px; background: red; color: white; border: none; border-radius: 3px; padding: 5px 8px; cursor: pointer; font-size: 12px;">‚ùå</button>
                        <div style="padding: 5px; background: #0a0a0a; font-size: 0.75em; color: #888; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;">${file.name}</div>
                    `;
                    preview.appendChild(photoDiv);
                };
                reader.readAsDataURL(file);
            }
        }

        // Remove photo from preview
        function removePhoto(index) {
            subjectPhotos.splice(index, 1);
            // Rebuild preview
            const preview = document.getElementById('subject-photos-preview');
            preview.innerHTML = '';
            subjectPhotos.forEach((photo, idx) => {
                const photoDiv = document.createElement('div');
                photoDiv.style.cssText = 'position: relative; border: 2px solid #4bff21; border-radius: 5px; overflow: hidden;';
                photoDiv.innerHTML = `
                    <img src="${photo.dataUri}" style="width: 100%; height: 150px; object-fit: cover;">
                    <button onclick="removePhoto(${idx})" style="position: absolute; top: 5px; right: 5px; background: red; color: white; border: none; border-radius: 3px; padding: 5px 8px; cursor: pointer; font-size: 12px;">‚ùå</button>
                    <div style="padding: 5px; background: #0a0a0a; font-size: 0.75em; color: #888; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;">${photo.filename}</div>
                `;
                preview.appendChild(photoDiv);
            });
        }

        // Collect social media accounts data
        function collectSocialAccounts() {
            const accounts = [];
            const platforms = document.querySelectorAll('.social-platform');

            platforms.forEach(input => {
                const entryId = input.getAttribute('data-entry');
                const platform = input.value.trim();
                const username = document.querySelector(`.social-username[data-entry="${entryId}"]`).value.trim();
                const accountId = document.querySelector(`.social-account-id[data-entry="${entryId}"]`).value.trim();
                const displayName = document.querySelector(`.social-display-name[data-entry="${entryId}"]`).value.trim();

                if (platform || username || accountId) {
                    accounts.push({
                        platform: platform,
                        username: username,
                        accountId: accountId,
                        displayName: displayName
                    });
                }
            });

            return accounts;
        }

        // Investigation Social Accounts Management
        let investigationSocialAccountCounter = 1;

        // Add another investigation social media account entry
        function addInvestigationSocialAccount() {
            investigationSocialAccountCounter++;
            const container = document.getElementById('investigation-social-accounts-container');
            const newEntry = document.createElement('div');
            newEntry.className = 'social-account-entry';
            newEntry.id = `inv-social-entry-${investigationSocialAccountCounter}`;
            newEntry.innerHTML = `
                <hr style="border-color: #00f0ff; margin: 15px 0;">
                <div class="form-row">
                    <div class="form-group">
                        <label>Platform:</label>
                        <input type="text" class="inv-social-platform" placeholder="Facebook, Instagram, Twitter..." data-entry="${investigationSocialAccountCounter}">
                    </div>
                    <div class="form-group">
                        <label>Username/Handle:</label>
                        <input type="text" class="inv-social-username" placeholder="@username" data-entry="${investigationSocialAccountCounter}">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Account ID:</label>
                        <input type="text" class="inv-social-account-id" placeholder="Numeric ID or unique identifier" data-entry="${investigationSocialAccountCounter}">
                    </div>
                    <div class="form-group">
                        <label>Profile URL:</label>
                        <input type="text" class="inv-social-url" placeholder="https://..." data-entry="${investigationSocialAccountCounter}">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Display Name:</label>
                        <input type="text" class="inv-social-display-name" placeholder="Name shown on profile" data-entry="${investigationSocialAccountCounter}">
                    </div>
                </div>
                <button class="btn" style="background-color: #ff0000; margin-top: 5px;" onclick="removeInvestigationSocialAccount(${investigationSocialAccountCounter})">‚ùå Remove This Account</button>
            `;
            container.appendChild(newEntry);
        }

        // Remove investigation social media account entry
        function removeInvestigationSocialAccount(entryId) {
            const entry = document.getElementById(`inv-social-entry-${entryId}`);
            if (entry) {
                entry.remove();
            }
        }

        // Collect investigation social media accounts data
        function collectInvestigationSocialAccounts() {
            const accounts = [];
            const platforms = document.querySelectorAll('.inv-social-platform');

            platforms.forEach(input => {
                const entryId = input.getAttribute('data-entry');
                const platform = input.value.trim();
                const username = document.querySelector(`.inv-social-username[data-entry="${entryId}"]`)?.value.trim() || '';
                const accountId = document.querySelector(`.inv-social-account-id[data-entry="${entryId}"]`)?.value.trim() || '';
                const url = document.querySelector(`.inv-social-url[data-entry="${entryId}"]`)?.value.trim() || '';
                const displayName = document.querySelector(`.inv-social-display-name[data-entry="${entryId}"]`)?.value.trim() || '';

                if (platform || username || accountId || url) {
                    accounts.push({
                        platform: platform,
                        username: username,
                        accountId: accountId,
                        url: url,
                        displayName: displayName
                    });
                }
            });

            return accounts;
        }

        // Save subject to localStorage
        function saveSubject() {
            const category = document.getElementById('subject-category').value.trim();
            const name = document.getElementById('subject-name').value.trim();
            const nickname = document.getElementById('subject-nickname').value.trim();
            const dob = document.getElementById('subject-dob').value.trim();
            const scope = document.getElementById('subject-scope').value.trim();
            const dlid = document.getElementById('subject-dlid').value.trim();
            const ssn = document.getElementById('subject-ssn').value.trim();
            const phone = document.getElementById('subject-phone').value.trim();
            const email = document.getElementById('subject-email').value.trim();
            const address = document.getElementById('subject-address').value.trim();
            const gang = document.getElementById('subject-gang').value.trim();
            const priors = document.getElementById('subject-priors').value.trim();
            const mo = document.getElementById('subject-mo').value.trim();
            const notes = document.getElementById('subject-notes').value.trim();
            const investigationLink = document.getElementById('subject-investigation').value;

            // Validation
            if (!name && !nickname) {
                alert('‚ö†Ô∏è Please enter at least a Name or Nickname for the subject.');
                return;
            }

            const socialAccounts = collectSocialAccounts();

            const subject = {
                id: currentEditingSubjectId || Date.now().toString(),
                category: category,
                name: name,
                nickname: nickname,
                dob: dob,
                scope: scope,
                dlid: dlid,
                ssn: ssn,
                phone: phone,
                email: email,
                address: address,
                gang: gang,
                priors: priors,
                mo: mo,
                notes: notes,
                socialAccounts: socialAccounts,
                photos: subjectPhotos,
                investigationLink: investigationLink,
                createdAt: currentEditingSubjectId ? undefined : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            // Get existing subjects from localStorage
            let subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');

            if (currentEditingSubjectId) {
                // Update existing subject
                const index = subjects.findIndex(s => s.id === currentEditingSubjectId);
                if (index !== -1) {
                    subject.createdAt = subjects[index].createdAt;
                    subjects[index] = subject;
                    alert(`‚úÖ Subject "${name || nickname}" updated successfully!`);
                }
            } else {
                // Add new subject
                subjects.push(subject);
                alert(`‚úÖ Subject "${name || nickname}" saved successfully!`);
            }

            // Save to localStorage
            localStorage.setItem('daisys_subjects', JSON.stringify(subjects));

            // Update category filter
            updateCategoryFilter();

            // Clear form
            clearSubjectForm();
            currentEditingSubjectId = null;
        }

        // Clear subject form
        function clearSubjectForm() {
            document.getElementById('subject-category').value = '';
            document.getElementById('subject-name').value = '';
            document.getElementById('subject-nickname').value = '';
            document.getElementById('subject-dob').value = '';
            document.getElementById('subject-scope').value = '';
            document.getElementById('subject-dlid').value = '';
            document.getElementById('subject-ssn').value = '';
            document.getElementById('subject-phone').value = '';
            document.getElementById('subject-email').value = '';
            document.getElementById('subject-address').value = '';
            document.getElementById('subject-gang').value = '';
            document.getElementById('subject-priors').value = '';
            document.getElementById('subject-mo').value = '';
            document.getElementById('subject-notes').value = '';
            document.getElementById('subject-investigation').value = '';

            // Clear social accounts (keep only first one)
            const container = document.getElementById('social-accounts-container');
            container.innerHTML = `
                <div class="social-account-entry" id="social-entry-1">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Platform:</label>
                            <input type="text" class="social-platform" placeholder="e.g., Facebook, Instagram, TikTok" data-entry="1">
                        </div>
                        <div class="form-group">
                            <label>Username/Handle:</label>
                            <input type="text" class="social-username" placeholder="@username" data-entry="1">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Account ID/URL:</label>
                            <input type="text" class="social-account-id" placeholder="Profile URL or account ID" data-entry="1">
                        </div>
                        <div class="form-group">
                            <label>Display Name:</label>
                            <input type="text" class="social-display-name" placeholder="Name shown on profile" data-entry="1">
                        </div>
                    </div>
                </div>
            `;
            socialAccountCounter = 1;

            // Clear photos
            subjectPhotos = [];
            document.getElementById('subject-photos-preview').innerHTML = '';
            document.getElementById('subject-photo-input').value = '';

            currentEditingSubjectId = null;
        }

        // View subjects list
        function viewSubjectsList() {
            const subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');
            const listContainer = document.getElementById('subjects-list-container');
            const listSection = document.getElementById('subjects-list');

            if (subjects.length === 0) {
                listContainer.innerHTML = '<p style="color: #888;">No subjects saved yet. Add your first subject above!</p>';
                listSection.style.display = 'block';
                return;
            }

            displaySubjects(subjects);
            listSection.style.display = 'block';

            // Scroll to list
            listSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Display subjects
        function displaySubjects(subjects) {
            const listContainer = document.getElementById('subjects-list-container');

            if (subjects.length === 0) {
                listContainer.innerHTML = '<p style="color: #888;">No subjects found matching your search.</p>';
                return;
            }

            let html = '';
            subjects.forEach((subject, index) => {
                const displayName = subject.name || subject.nickname || 'Unknown';
                const categoryBadge = subject.category ? `<span style="background: #f8e602; color: #000; padding: 2px 8px; border-radius: 3px; font-size: 0.85em; font-weight: bold;">${subject.category}</span>` : '';
                const gangBadge = subject.gang ? `<span style="background: #ff0000; color: #fff; padding: 2px 8px; border-radius: 3px; font-size: 0.85em; margin-left: 5px;">üö© Gang: ${subject.gang}</span>` : '';

                const photoCount = subject.photos ? subject.photos.length : 0;
                const socialCount = subject.socialAccounts ? subject.socialAccounts.length : 0;

                html += `
                    <div style="background: #1a1a1a; border: 2px solid #4bff21; border-radius: 5px; padding: 15px; margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <div>
                                <h4 style="color: #00f0ff; margin: 0;">${displayName}</h4>
                                ${categoryBadge} ${gangBadge}
                            </div>
                            <div>
                                <button class="btn" onclick="exportSubjectAsMarkdown('${subject.id}')" style="background: #f8e602; color: #000; margin-right: 5px;">üìÑ Export</button>
                                <button class="btn" onclick="editSubject('${subject.id}')" style="background: #00f0ff; margin-right: 5px;">‚úèÔ∏è Edit</button>
                                <button class="btn" onclick="deleteSubject('${subject.id}')" style="background: #ff0000;">üóëÔ∏è Delete</button>
                            </div>
                        </div>

                        <div style="color: #888; font-size: 0.9em; margin-top: 10px;">
                            ${subject.nickname ? `<div><strong>Nickname:</strong> ${subject.nickname}</div>` : ''}
                            ${subject.dob ? `<div><strong>DOB:</strong> ${subject.dob}</div>` : ''}
                            ${subject.phone ? `<div><strong>Phone:</strong> ${subject.phone}</div>` : ''}
                            ${subject.email ? `<div><strong>Email:</strong> ${subject.email}</div>` : ''}
                            ${subject.address ? `<div><strong>Address:</strong> ${subject.address}</div>` : ''}
                            ${subject.priors ? `<div style="color: #ffcc99;"><strong>Priors:</strong> ${subject.priors.substring(0, 100)}${subject.priors.length > 100 ? '...' : ''}</div>` : ''}
                            <div style="margin-top: 10px;">
                                <span style="background: #0a0a0a; padding: 5px 10px; border-radius: 3px; margin-right: 10px;">üì± ${socialCount} Social Accounts</span>
                                <span style="background: #0a0a0a; padding: 5px 10px; border-radius: 3px;">üì∏ ${photoCount} Photos</span>
                            </div>
                            ${subject.createdAt ? `<div style="margin-top: 5px; font-size: 0.8em;">Added: ${new Date(subject.createdAt).toLocaleString()}</div>` : ''}
                        </div>

                        <button class="btn" onclick="viewSubjectDetails('${subject.id}')" style="margin-top: 10px; background: #772289;">üëÅÔ∏è View Full Details</button>
                    </div>
                `;
            });

            listContainer.innerHTML = html;
        }

        // Search subjects
        function searchSubjects() {
            const searchTerm = document.getElementById('subjects-search').value.toLowerCase();
            const subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');

            const filtered = subjects.filter(subject => {
                return (
                    (subject.name && subject.name.toLowerCase().includes(searchTerm)) ||
                    (subject.nickname && subject.nickname.toLowerCase().includes(searchTerm)) ||
                    (subject.category && subject.category.toLowerCase().includes(searchTerm)) ||
                    (subject.gang && subject.gang.toLowerCase().includes(searchTerm)) ||
                    (subject.phone && subject.phone.includes(searchTerm)) ||
                    (subject.email && subject.email.toLowerCase().includes(searchTerm)) ||
                    (subject.address && subject.address.toLowerCase().includes(searchTerm)) ||
                    (subject.priors && subject.priors.toLowerCase().includes(searchTerm)) ||
                    (subject.notes && subject.notes.toLowerCase().includes(searchTerm))
                );
            });

            displaySubjects(filtered);
        }

        // Filter subjects by category
        function filterSubjectsByCategory() {
            const category = document.getElementById('subjects-category-filter').value;
            const subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');

            if (!category) {
                displaySubjects(subjects);
                return;
            }

            const filtered = subjects.filter(subject => subject.category === category);
            displaySubjects(filtered);
        }

        // Update category filter dropdown
        function updateCategoryFilter() {
            const subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');
            const categories = [...new Set(subjects.map(s => s.category).filter(c => c))];

            const select = document.getElementById('subjects-category-filter');
            select.innerHTML = '<option value="">All Categories</option>';

            categories.sort().forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                select.appendChild(option);
            });
        }

        // Edit subject
        function editSubject(subjectId) {
            const subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');
            const subject = subjects.find(s => s.id === subjectId);

            if (!subject) {
                alert('Subject not found!');
                return;
            }

            // Populate form
            document.getElementById('subject-category').value = subject.category || '';
            document.getElementById('subject-name').value = subject.name || '';
            document.getElementById('subject-nickname').value = subject.nickname || '';
            document.getElementById('subject-dob').value = subject.dob || '';
            document.getElementById('subject-scope').value = subject.scope || '';
            document.getElementById('subject-dlid').value = subject.dlid || '';
            document.getElementById('subject-ssn').value = subject.ssn || '';
            document.getElementById('subject-phone').value = subject.phone || '';
            document.getElementById('subject-email').value = subject.email || '';
            document.getElementById('subject-address').value = subject.address || '';
            document.getElementById('subject-gang').value = subject.gang || '';
            document.getElementById('subject-priors').value = subject.priors || '';
            document.getElementById('subject-mo').value = subject.mo || '';
            document.getElementById('subject-notes').value = subject.notes || '';
            document.getElementById('subject-investigation').value = subject.investigationLink || '';

            // Populate social accounts
            const container = document.getElementById('social-accounts-container');
            container.innerHTML = '';
            socialAccountCounter = 0;

            if (subject.socialAccounts && subject.socialAccounts.length > 0) {
                subject.socialAccounts.forEach((account, index) => {
                    socialAccountCounter++;
                    const entryDiv = document.createElement('div');
                    entryDiv.className = 'social-account-entry';
                    entryDiv.id = `social-entry-${socialAccountCounter}`;
                    entryDiv.innerHTML = `
                        ${index > 0 ? '<hr style="border-color: #4bff21; margin: 15px 0;">' : ''}
                        <div class="form-row">
                            <div class="form-group">
                                <label>Platform:</label>
                                <input type="text" class="social-platform" placeholder="e.g., Facebook, Instagram, TikTok" data-entry="${socialAccountCounter}" value="${account.platform || ''}">
                            </div>
                            <div class="form-group">
                                <label>Username/Handle:</label>
                                <input type="text" class="social-username" placeholder="@username" data-entry="${socialAccountCounter}" value="${account.username || ''}">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Account ID/URL:</label>
                                <input type="text" class="social-account-id" placeholder="Profile URL or account ID" data-entry="${socialAccountCounter}" value="${account.accountId || ''}">
                            </div>
                            <div class="form-group">
                                <label>Display Name:</label>
                                <input type="text" class="social-display-name" placeholder="Name shown on profile" data-entry="${socialAccountCounter}" value="${account.displayName || ''}">
                            </div>
                        </div>
                        ${index > 0 ? `<button class="btn" style="background-color: #ff0000; margin-top: 5px;" onclick="removeSocialAccount(${socialAccountCounter})">‚ùå Remove This Account</button>` : ''}
                    `;
                    container.appendChild(entryDiv);
                });
            } else {
                // Add default empty entry
                socialAccountCounter = 1;
                container.innerHTML = `
                    <div class="social-account-entry" id="social-entry-1">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Platform:</label>
                                <input type="text" class="social-platform" placeholder="e.g., Facebook, Instagram, TikTok" data-entry="1">
                            </div>
                            <div class="form-group">
                                <label>Username/Handle:</label>
                                <input type="text" class="social-username" placeholder="@username" data-entry="1">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Account ID/URL:</label>
                                <input type="text" class="social-account-id" placeholder="Profile URL or account ID" data-entry="1">
                            </div>
                            <div class="form-group">
                                <label>Display Name:</label>
                                <input type="text" class="social-display-name" placeholder="Name shown on profile" data-entry="1">
                            </div>
                        </div>
                    </div>
                `;
            }

            // Populate photos
            subjectPhotos = subject.photos || [];
            const preview = document.getElementById('subject-photos-preview');
            preview.innerHTML = '';
            subjectPhotos.forEach((photo, idx) => {
                const photoDiv = document.createElement('div');
                photoDiv.style.cssText = 'position: relative; border: 2px solid #4bff21; border-radius: 5px; overflow: hidden;';
                photoDiv.innerHTML = `
                    <img src="${photo.dataUri}" style="width: 100%; height: 150px; object-fit: cover;">
                    <button onclick="removePhoto(${idx})" style="position: absolute; top: 5px; right: 5px; background: red; color: white; border: none; border-radius: 3px; padding: 5px 8px; cursor: pointer; font-size: 12px;">‚ùå</button>
                    <div style="padding: 5px; background: #0a0a0a; font-size: 0.75em; color: #888; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;">${photo.filename}</div>
                `;
                preview.appendChild(photoDiv);
            });

            currentEditingSubjectId = subjectId;

            // Scroll to top of subjects tab
            showTab('subjects');
            window.scrollTo(0, 0);

            alert(`üìù Now editing: ${subject.name || subject.nickname}`);
        }

        // Delete subject
        function deleteSubject(subjectId) {
            const subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');
            const subject = subjects.find(s => s.id === subjectId);

            if (!subject) {
                alert('Subject not found!');
                return;
            }

            const confirmDelete = confirm(`‚ö†Ô∏è Are you sure you want to delete "${subject.name || subject.nickname}"?\n\nThis action cannot be undone.`);

            if (confirmDelete) {
                const filtered = subjects.filter(s => s.id !== subjectId);
                localStorage.setItem('daisys_subjects', JSON.stringify(filtered));
                alert('‚úÖ Subject deleted successfully.');
                viewSubjectsList();
                updateCategoryFilter();
            }
        }

        // View full subject details
        function viewSubjectDetails(subjectId) {
            const subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');
            const subject = subjects.find(s => s.id === subjectId);

            if (!subject) {
                alert('Subject not found!');
                return;
            }

            let details = `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
            details += `üë§ SUBJECT DETAILS\n`;
            details += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n`;

            if (subject.category) details += `üìÇ CATEGORY: ${subject.category}\n\n`;

            details += `üë§ PERSONAL INFORMATION:\n`;
            details += `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
            if (subject.name) details += `Name: ${subject.name}\n`;
            if (subject.nickname) details += `Nickname/AKA: ${subject.nickname}\n`;
            if (subject.dob) details += `DOB: ${subject.dob}\n`;
            if (subject.scope) details += `SCOPE: ${subject.scope}\n`;
            if (subject.dlid) details += `DL/ID: ${subject.dlid}\n`;
            if (subject.ssn) details += `SSN: ${subject.ssn}\n`;
            if (subject.phone) details += `Phone: ${subject.phone}\n`;
            if (subject.email) details += `Email: ${subject.email}\n`;
            if (subject.address) details += `Address: ${subject.address}\n`;

            if (subject.socialAccounts && subject.socialAccounts.length > 0) {
                details += `\nüì± SOCIAL MEDIA ACCOUNTS:\n`;
                details += `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
                subject.socialAccounts.forEach((account, index) => {
                    details += `\n[${index + 1}] ${account.platform || 'Unknown Platform'}\n`;
                    if (account.username) details += `  Username: ${account.username}\n`;
                    if (account.accountId) details += `  Account ID/URL: ${account.accountId}\n`;
                    if (account.displayName) details += `  Display Name: ${account.displayName}\n`;
                });
            }

            if (subject.gang) {
                details += `\nüö© GANG AFFILIATION:\n`;
                details += `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
                details += `${subject.gang}\n`;
            }

            if (subject.priors) {
                details += `\n‚ö†Ô∏è PRIORS / CRIMINAL HISTORY:\n`;
                details += `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
                details += `${subject.priors}\n`;
            }

            if (subject.mo) {
                details += `\nüéØ MODUS OPERANDI:\n`;
                details += `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
                details += `${subject.mo}\n`;
            }

            if (subject.notes) {
                details += `\nüìù INVESTIGATION NOTES:\n`;
                details += `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
                details += `${subject.notes}\n`;
            }

            if (subject.photos && subject.photos.length > 0) {
                details += `\nüì∏ ATTACHED PHOTOS: ${subject.photos.length}\n`;
            }

            if (subject.createdAt) {
                details += `\n‚è∞ Created: ${new Date(subject.createdAt).toLocaleString()}\n`;
            }
            if (subject.updatedAt) {
                details += `Updated: ${new Date(subject.updatedAt).toLocaleString()}\n`;
            }

            details += `\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`;

            alert(details);
        }

        // Hide subjects list
        function hideSubjectsList() {
            document.getElementById('subjects-list').style.display = 'none';
        }

        // Export subject as markdown
        function exportSubjectAsMarkdown(subjectId) {
            const subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');
            const subject = subjects.find(s => s.id === subjectId);

            if (!subject) {
                alert('Subject not found!');
                return;
            }

            // Build markdown content
            let markdown = `# ${subject.name || subject.nickname || 'Unknown Subject'}\n\n`;

            if (subject.category) {
                markdown += `**Category:** ${subject.category}\n\n`;
            }

            markdown += `## Personal Information\n\n`;
            if (subject.name) markdown += `- **Full Name:** ${subject.name}\n`;
            if (subject.nickname) markdown += `- **Nickname/AKA:** ${subject.nickname}\n`;
            if (subject.dob) markdown += `- **Date of Birth:** ${subject.dob}\n`;
            if (subject.scope) markdown += `- **SCOPE ID:** ${subject.scope}\n`;
            if (subject.dlid) markdown += `- **DL/ID Number:** ${subject.dlid}\n`;
            if (subject.ssn) markdown += `- **SSN:** ${subject.ssn}\n`;
            if (subject.phone) markdown += `- **Phone:** ${subject.phone}\n`;
            if (subject.email) markdown += `- **Email:** ${subject.email}\n`;
            if (subject.address) markdown += `- **Address:** ${subject.address}\n`;

            if (subject.socialAccounts && subject.socialAccounts.length > 0) {
                markdown += `\n## Social Media Accounts\n\n`;
                subject.socialAccounts.forEach((account, index) => {
                    markdown += `### ${index + 1}. ${account.platform || 'Unknown Platform'}\n\n`;
                    if (account.username) markdown += `- **Username:** ${account.username}\n`;
                    if (account.accountId) markdown += `- **Account ID/URL:** ${account.accountId}\n`;
                    if (account.displayName) markdown += `- **Display Name:** ${account.displayName}\n`;
                    markdown += `\n`;
                });
            }

            if (subject.gang) {
                markdown += `## Gang Affiliation\n\n${subject.gang}\n\n`;
            }

            if (subject.priors) {
                markdown += `## Priors / Criminal History\n\n${subject.priors}\n\n`;
            }

            if (subject.mo) {
                markdown += `## Modus Operandi\n\n${subject.mo}\n\n`;
            }

            if (subject.notes) {
                markdown += `## Investigation Notes\n\n${subject.notes}\n\n`;
            }

            if (subject.photos && subject.photos.length > 0) {
                markdown += `## Attached Photos\n\n`;
                markdown += `Total photos: ${subject.photos.length}\n\n`;
                subject.photos.forEach((photo, index) => {
                    markdown += `- Photo ${index + 1}: ${photo.filename}\n`;
                });
                markdown += `\n`;
            }

            markdown += `---\n\n`;
            if (subject.createdAt) {
                markdown += `*Created: ${new Date(subject.createdAt).toLocaleString()}*\n\n`;
            }
            if (subject.updatedAt) {
                markdown += `*Updated: ${new Date(subject.updatedAt).toLocaleString()}*\n\n`;
            }

            // Add metadata at end for import
            markdown += `<!-- DAISY_TRACKER_METADATA\n`;
            markdown += JSON.stringify(subject, null, 2);
            markdown += `\n-->\n`;

            // Filename
            const filename = `${(subject.name || subject.nickname || 'Subject').replace(/[^a-z0-9]/gi, '_')}_${subject.id}.md`;

            // Save to device file system if Cordova is available
            const baseDir = getStorageLocation();

            if (baseDir && baseDir !== 'custom' && typeof cordova !== 'undefined') {
                saveMarkdownToDevice(markdown, filename, baseDir);
            } else {
                // Fallback: Download as blob (works in browser)
                const blob = new Blob([markdown], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                alert(`‚úÖ Subject exported as markdown file!`);
            }
        }

        // Save markdown to device file system
        function saveMarkdownToDevice(content, filename, baseDir) {
            window.resolveLocalFileSystemURL(baseDir, function(dirEntry) {
                dirEntry.getFile(filename, { create: true, exclusive: false }, function(fileEntry) {
                    fileEntry.createWriter(function(fileWriter) {
                        fileWriter.onwriteend = function() {
                            alert(`‚úÖ Subject exported to:\n${fileEntry.nativeURL}`);
                        };

                        fileWriter.onerror = function(e) {
                            alert(`‚ùå Error writing file: ${e.toString()}`);
                        };

                        const blob = new Blob([content], { type: 'text/markdown' });
                        fileWriter.write(blob);
                    }, function(error) {
                        alert(`‚ùå Error creating file writer: ${error.code}`);
                    });
                }, function(error) {
                    alert(`‚ùå Error creating file: ${error.code}`);
                });
            }, function(error) {
                alert(`‚ùå Error accessing directory: ${error.code}`);
            });
        }

        // Import subject from markdown
        function importSubjectFromMarkdown(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;

                // Extract metadata from HTML comment
                const metadataMatch = content.match(/<!-- DAISY_TRACKER_METADATA\n([\s\S]*?)\n-->/);

                if (!metadataMatch) {
                    alert('‚ö†Ô∏è This file does not contain valid Daisy\'s Tracker metadata. Cannot import.');
                    return;
                }

                try {
                    const subject = JSON.parse(metadataMatch[1]);

                    // Generate new ID to avoid conflicts
                    subject.id = Date.now().toString();
                    subject.createdAt = new Date().toISOString();
                    subject.updatedAt = new Date().toISOString();

                    // Get existing subjects
                    let subjects = JSON.parse(localStorage.getItem('daisys_subjects') || '[]');

                    // Add imported subject
                    subjects.push(subject);
                    localStorage.setItem('daisys_subjects', JSON.stringify(subjects));

                    updateCategoryFilter();

                    alert(`‚úÖ Subject "${subject.name || subject.nickname}" imported successfully!`);

                    // Refresh list if open
                    if (document.getElementById('subjects-list').style.display !== 'none') {
                        viewSubjectsList();
                    }
                } catch (error) {
                    alert(`‚ùå Error importing subject: ${error.message}`);
                }
            };

            reader.readAsText(file);

            // Clear file input
            event.target.value = '';
        }

        // Toggle Subject Profile section visibility
        // Show save inputs form - redirects user to subject profile section
        function showSaveInputsForm() {
            const fieldsDiv = document.getElementById('subject-profile-fields');
            const btn = document.getElementById('save-inputs-btn');
            const section = document.getElementById('save-inputs-section');

            // Show the subject profile fields
            fieldsDiv.style.display = 'block';

            // Hide the "Save inputs as file" button
            btn.style.display = 'none';

            // Scroll to the section
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });

            // Show a message
            setTimeout(() => {
                alert('‚úèÔ∏è Fill out the Subject Profile fields below, then click "Save as Subject Profile (MD File)" at the bottom.');
            }, 500);
        }

        // Clear only subject-specific fields (not main investigation fields)
        function clearSubjectFields() {
            // Clear subject-specific inputs
            document.getElementById('subject-category').value = '';
            document.getElementById('subject-gang').value = '';
            document.getElementById('subject-priors').value = '';
            document.getElementById('subject-mo').value = '';

            // Reset social accounts to single empty entry
            const container = document.getElementById('social-accounts-container');
            socialAccountCounter = 1;
            container.innerHTML = `
                <div class="social-account-entry" id="social-entry-1">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Platform:</label>
                            <input type="text" class="social-platform" placeholder="Facebook, Instagram..." data-entry="1">
                        </div>
                        <div class="form-group">
                            <label>Username:</label>
                            <input type="text" class="social-username" placeholder="@username" data-entry="1">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>URL/ID:</label>
                            <input type="text" class="social-account-id" placeholder="Profile URL" data-entry="1">
                        </div>
                        <div class="form-group">
                            <label>Display Name:</label>
                            <input type="text" class="social-display-name" placeholder="Profile name" data-entry="1">
                        </div>
                    </div>
                </div>
            `;

            // Clear photos
            subjectPhotos = [];
            document.getElementById('subject-photos-preview').innerHTML = '';
            document.getElementById('subject-photo-input').value = '';

            // Hide the subject profile fields section
            document.getElementById('subject-profile-fields').style.display = 'none';

            // Show the "Save inputs as file" button again
            document.getElementById('save-inputs-btn').style.display = 'block';

            alert('‚úÖ Subject fields cleared! Investigation fields remain unchanged.');
        }

        // Initialize category filter on page load
        window.addEventListener('load', function() {
            updateCategoryFilter();
        });

        // Load files on page load
        window.addEventListener('load', loadFiles);
    </script>
</body>
</html>
